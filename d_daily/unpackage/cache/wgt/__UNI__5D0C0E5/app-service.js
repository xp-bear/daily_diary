if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}const a="http://120.48.51.185:4500/api",s="userToken",o="userInfo";function n(e,t={}){return new Promise(((o,n)=>{const l=uni.getStorageSync(s),i={url:a+e,method:t.method||"GET",data:t.data||{},timeout:t.timeout||1e4,header:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{},...t.header||{}}};!1!==t.showLoading&&uni.showLoading({title:t.loadingText||"Âä†ËΩΩ‰∏≠...",mask:!0}),uni.request({...i,success:e=>{var a;if(!1!==t.showLoading&&uni.hideLoading(),200===e.statusCode){const a=e.data;if(200===a.code)o(a.data);else{const e=a.message||"ËØ∑Ê±ÇÂ§±Ë¥•";!1!==t.showError&&uni.showToast({title:e,icon:"none",duration:2e3}),n(new Error(e))}}else if(401===e.statusCode)uni.removeStorageSync(s),uni.removeStorageSync("userInfo"),uni.showToast({title:"ÁôªÂΩïÂ∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï",icon:"none",duration:2e3}),setTimeout((()=>{uni.reLaunch({url:"/pages/login/login"})}),2e3),n(new Error("Êú™ÊéàÊùÉ"));else{const s=(null==(a=e.data)?void 0:a.message)||"ËØ∑Ê±ÇÂ§±Ë¥•";!1!==t.showError&&uni.showToast({title:s,icon:"none",duration:2e3}),n(new Error(s))}},fail:e=>{!1!==t.showLoading&&uni.hideLoading();const a="ÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËÆæÁΩÆ";!1!==t.showError&&uni.showToast({title:a,icon:"none",duration:2e3}),n(new Error(a))}})}))}function l(e,t,a={}){if(t){e=`${e}?${Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&")}`}return n(e,{method:"GET",...a})}function i(e,t,a={}){return n(e,{method:"POST",data:t,...a})}function c(){return l("/auth/userinfo")}function r(e){return function(e,t,a={}){return n(e,{method:"PUT",data:t,...a})}("/auth/userinfo",e)}const d=(e,t)=>{const a=e.__vccOpts||e;for(const[s,o]of t)a[s]=o;return a};const m=d({data:()=>({username:"",password:"",showPassword:!1,rememberMe:!1}),onLoad(){uni.getStorageSync("userToken")&&this.checkAutoLogin(),this.loadRememberedAccount()},methods:{loadRememberedAccount(){const e=uni.getStorageSync("rememberedAccount");if(e)try{const t=JSON.parse(e);this.username=t.username||"",this.password=t.password||"",this.rememberMe=!0}catch(a){t("error","at pages/login/login.vue:119","Âä†ËΩΩËÆ∞‰ΩèÁöÑË¥¶Âè∑Â§±Ë¥•",a)}},checkAutoLogin(){uni.getStorageSync("userInfo")&&uni.reLaunch({url:"/pages/index/index"})},togglePassword(){this.showPassword=!this.showPassword},toggleRemember(){this.rememberMe=!this.rememberMe},handleLogin(){this.username.trim()?this.password.trim()?this.password.length<6?uni.showToast({title:"ÂØÜÁ†ÅÈïøÂ∫¶‰∏çËÉΩÂ∞ë‰∫é6‰Ωç",icon:"none"}):this.doLogin():uni.showToast({title:"ËØ∑ËæìÂÖ•ÂØÜÁ†Å",icon:"none"}):uni.showToast({title:"ËØ∑ËæìÂÖ•Ë¥¶Âè∑",icon:"none"})},async doLogin(){try{const t=await(e={username:this.username,password:this.password},i("/auth/login",e));uni.setStorageSync(s,t.token),uni.setStorageSync(o,JSON.stringify(t.userInfo)),uni.setStorageSync("currentUser",t.userInfo.username),this.rememberMe?uni.setStorageSync("rememberedAccount",JSON.stringify({username:this.username,password:this.password})):uni.removeStorageSync("rememberedAccount"),uni.showToast({title:"ÁôªÂΩïÊàêÂäü",icon:"success",duration:1500}),setTimeout((()=>{uni.reLaunch({url:"/pages/index/index"})}),1500)}catch(a){t("error","at pages/login/login.vue:206","ÁôªÂΩïÂ§±Ë¥•:",a)}var e},goRegister(){uni.navigateTo({url:"/pages/register/register"})},forgetPassword(){uni.showModal({title:"ÊâæÂõûÂØÜÁ†Å",content:"ËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëòÈáçÁΩÆÂØÜÁ†Å\nÊàñÈÄöËøáÈÇÆÁÆ±/ÊâãÊú∫È™åËØÅÊâæÂõû",showCancel:!1})},wechatLogin(){uni.showToast({title:"ÂæÆ‰ø°ÁôªÂΩïÂºÄÂèë‰∏≠",icon:"none"})},qqLogin(){uni.showToast({title:"QQÁôªÂΩïÂºÄÂèë‰∏≠",icon:"none"})},phoneLogin(){uni.showToast({title:"ÊâãÊú∫È™åËØÅÁ†ÅÁôªÂΩïÂºÄÂèë‰∏≠",icon:"none"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"logo-section"},[e.createElementVNode("text",{class:"logo-icon"},"üìù"),e.createElementVNode("text",{class:"app-name"},"ÊØèÊó•Êó•ËÆ∞"),e.createElementVNode("text",{class:"app-slogan"},"ËÆ∞ÂΩïÁîüÊ¥ªÔºåÁïô‰ΩèÁæéÂ•Ω")]),e.createElementVNode("view",{class:"form-section card"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üë§"),e.createElementVNode("text",{class:"label-text"},"Ë¥¶Âè∑")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.username=e),placeholder:"ËØ∑ËæìÂÖ•Áî®Êà∑Âêç/ÊâãÊú∫Âè∑/ÈÇÆÁÆ±","placeholder-style":"color: #CCCCCC;"},null,512),[[e.vModelText,n.username]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üîí"),e.createElementVNode("text",{class:"label-text"},"ÂØÜÁ†Å")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[1]||(a[1]=e=>n.password=e),password:!n.showPassword,placeholder:"ËØ∑ËæìÂÖ•ÂØÜÁ†Å","placeholder-style":"color: #CCCCCC;"},null,8,["password"]),[[e.vModelText,n.password]]),e.createElementVNode("text",{class:"password-toggle",onClick:a[2]||(a[2]=(...e)=>l.togglePassword&&l.togglePassword(...e))},e.toDisplayString(n.showPassword?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è"),1)]),e.createElementVNode("view",{class:"form-options"},[e.createElementVNode("view",{class:"remember-box",onClick:a[3]||(a[3]=(...e)=>l.toggleRemember&&l.toggleRemember(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["checkbox",{checked:n.rememberMe}])},e.toDisplayString(n.rememberMe?"‚òëÔ∏è":"‚¨ú"),3),e.createElementVNode("text",{class:"option-text"},"ËÆ∞‰ΩèÂØÜÁ†Å")]),e.createElementVNode("text",{class:"forget-text",onClick:a[4]||(a[4]=(...e)=>l.forgetPassword&&l.forgetPassword(...e))},"ÂøòËÆ∞ÂØÜÁ†ÅÔºü")]),e.createElementVNode("button",{class:"login-btn btn-primary",onClick:a[5]||(a[5]=(...e)=>l.handleLogin&&l.handleLogin(...e))},"ÁôªÂΩï"),e.createElementVNode("view",{class:"register-tip"},[e.createElementVNode("text",{class:"tip-text"},"ËøòÊ≤°ÊúâË¥¶Âè∑Ôºü"),e.createElementVNode("text",{class:"register-link",onClick:a[6]||(a[6]=(...e)=>l.goRegister&&l.goRegister(...e))},"Á´ãÂç≥Ê≥®ÂÜå")])]),e.createElementVNode("view",{class:"social-login"},[e.createElementVNode("view",{class:"divider-box"},[e.createElementVNode("view",{class:"divider-line"}),e.createElementVNode("text",{class:"divider-text"},"ÂÖ∂‰ªñÁôªÂΩïÊñπÂºè"),e.createElementVNode("view",{class:"divider-line"})]),e.createElementVNode("view",{class:"social-icons"},[e.createElementVNode("view",{class:"social-item",onClick:a[7]||(a[7]=(...e)=>l.wechatLogin&&l.wechatLogin(...e))},[e.createElementVNode("text",{class:"social-icon"},"üí¨"),e.createElementVNode("text",{class:"social-name"},"ÂæÆ‰ø°")]),e.createElementVNode("view",{class:"social-item",onClick:a[8]||(a[8]=(...e)=>l.qqLogin&&l.qqLogin(...e))},[e.createElementVNode("text",{class:"social-icon"},"üêß"),e.createElementVNode("text",{class:"social-name"},"QQ")]),e.createElementVNode("view",{class:"social-item",onClick:a[9]||(a[9]=(...e)=>l.phoneLogin&&l.phoneLogin(...e))},[e.createElementVNode("text",{class:"social-icon"},"üì±"),e.createElementVNode("text",{class:"social-name"},"ÊâãÊú∫")])])])])}],["__scopeId","data-v-1b41e8e0"]]);const u=d({data:()=>({username:"",nickname:"",email:"",phone:"",password:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1,agreedToTerms:!1}),methods:{togglePassword(){this.showPassword=!this.showPassword},toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword},toggleAgreement(){this.agreedToTerms=!this.agreedToTerms},validateForm(){return this.username.trim()?this.username.length<6||this.username.length>20?(uni.showToast({title:"Áî®Êà∑ÂêçÈïøÂ∫¶‰∏∫6-20‰Ωç",icon:"none"}),!1):/^[a-zA-Z0-9]+$/.test(this.username)?this.nickname.trim()?this.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.email)?(uni.showToast({title:"ÈÇÆÁÆ±Ê†ºÂºè‰∏çÊ≠£Á°Æ",icon:"none"}),!1):this.phone&&!/^1[3-9]\d{9}$/.test(this.phone)?(uni.showToast({title:"ÊâãÊú∫Âè∑Ê†ºÂºè‰∏çÊ≠£Á°Æ",icon:"none"}),!1):this.password?this.password.length<6?(uni.showToast({title:"ÂØÜÁ†ÅÈïøÂ∫¶‰∏çËÉΩÂ∞ë‰∫é6‰Ωç",icon:"none"}),!1):this.password!==this.confirmPassword?(uni.showToast({title:"‰∏§Ê¨°ÂØÜÁ†ÅËæìÂÖ•‰∏ç‰∏ÄËá¥",icon:"none"}),!1):!!this.agreedToTerms||(uni.showToast({title:"ËØ∑ÈòÖËØªÂπ∂ÂêåÊÑèÁî®Êà∑ÂçèËÆÆ",icon:"none"}),!1):(uni.showToast({title:"ËØ∑ËæìÂÖ•ÂØÜÁ†Å",icon:"none"}),!1):(uni.showToast({title:"ËØ∑ËæìÂÖ•ÊòµÁß∞",icon:"none"}),!1):(uni.showToast({title:"Áî®Êà∑ÂêçÂè™ËÉΩÂåÖÂê´Â≠óÊØçÂíåÊï∞Â≠ó",icon:"none"}),!1):(uni.showToast({title:"ËØ∑ËæìÂÖ•Áî®Êà∑Âêç",icon:"none"}),!1)},handleRegister(){this.validateForm()&&this.doRegister()},async doRegister(){try{const t=await(e={username:this.username,password:this.password,nickname:this.nickname,email:this.email||void 0,phone:this.phone||void 0},i("/auth/register",e));uni.setStorageSync(s,t.token),uni.setStorageSync(o,JSON.stringify(t.userInfo)),uni.setStorageSync("currentUser",t.userInfo.username),uni.showToast({title:"Ê≥®ÂÜåÊàêÂäü",icon:"success",duration:1500}),setTimeout((()=>{uni.reLaunch({url:"/pages/index/index"})}),1500)}catch(a){t("error","at pages/register/register.vue:282","Ê≥®ÂÜåÂ§±Ë¥•:",a)}var e},goLogin(){uni.navigateBack()},showTerms(){uni.showModal({title:"Áî®Êà∑ÂçèËÆÆ",content:"ËøôÈáåÊòØÁî®Êà∑ÂçèËÆÆÁöÑÂÜÖÂÆπ...\n\n1. Áî®Êà∑ÈúÄÈÅµÂÆàÁõ∏ÂÖ≥Ê≥ïÂæãÊ≥ïËßÑ\n2. ‰øùÊä§‰∏™‰∫∫ÈöêÁßÅ‰ø°ÊÅØ\n3. ÊñáÊòé‰ΩøÁî®Â∫îÁî®ÂäüËÉΩ",showCancel:!1})},showPrivacy(){uni.showModal({title:"ÈöêÁßÅÊîøÁ≠ñ",content:"ËøôÈáåÊòØÈöêÁßÅÊîøÁ≠ñÁöÑÂÜÖÂÆπ...\n\n1. Êàë‰ª¨ÈáçËßÜÊÇ®ÁöÑÈöêÁßÅ\n2. Êï∞ÊçÆ‰ªÖÂ≠òÂÇ®Âú®Êú¨Âú∞\n3. ‰∏ç‰ºöÊ≥ÑÈú≤ÊÇ®ÁöÑ‰∏™‰∫∫‰ø°ÊÅØ",showCancel:!1})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"header-section"},[e.createElementVNode("text",{class:"page-title"},"ÂàõÂª∫Ë¥¶Âè∑"),e.createElementVNode("text",{class:"page-subtitle"},"Âä†ÂÖ•Êàë‰ª¨ÔºåÂºÄÂßãËÆ∞ÂΩï‰Ω†ÁöÑÁîüÊ¥ª")]),e.createElementVNode("view",{class:"form-section card"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üë§"),e.createElementVNode("text",{class:"label-text"},"Áî®Êà∑Âêç")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.username=e),placeholder:"ËÆæÁΩÆÁî®Êà∑ÂêçÔºà6-20‰ΩçÂ≠óÊØçÊï∞Â≠óÔºâ","placeholder-style":"color: #CCCCCC;",maxlength:"20"},null,512),[[e.vModelText,n.username]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"‚ú®"),e.createElementVNode("text",{class:"label-text"},"ÊòµÁß∞")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[1]||(a[1]=e=>n.nickname=e),placeholder:"ÁªôËá™Â∑±Ëµ∑‰∏™Â•ΩÂê¨ÁöÑÊòµÁß∞","placeholder-style":"color: #CCCCCC;",maxlength:"20"},null,512),[[e.vModelText,n.nickname]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üìß"),e.createElementVNode("text",{class:"label-text"},"ÈÇÆÁÆ±ÔºàÂèØÈÄâÔºâ")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[2]||(a[2]=e=>n.email=e),placeholder:"Áî®‰∫éÊâæÂõûÂØÜÁ†Å","placeholder-style":"color: #CCCCCC;",type:"email"},null,512),[[e.vModelText,n.email]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üì±"),e.createElementVNode("text",{class:"label-text"},"ÊâãÊú∫Âè∑ÔºàÂèØÈÄâÔºâ")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[3]||(a[3]=e=>n.phone=e),placeholder:"Áî®‰∫éÊâæÂõûÂØÜÁ†Å","placeholder-style":"color: #CCCCCC;",type:"number",maxlength:"11"},null,512),[[e.vModelText,n.phone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üîí"),e.createElementVNode("text",{class:"label-text"},"ÂØÜÁ†Å")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[4]||(a[4]=e=>n.password=e),password:!n.showPassword,placeholder:"ËÆæÁΩÆÂØÜÁ†ÅÔºàËá≥Â∞ë6‰ΩçÔºâ","placeholder-style":"color: #CCCCCC;"},null,8,["password"]),[[e.vModelText,n.password]]),e.createElementVNode("text",{class:"password-toggle",onClick:a[5]||(a[5]=(...e)=>l.togglePassword&&l.togglePassword(...e))},e.toDisplayString(n.showPassword?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è"),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-icon"},"üîê"),e.createElementVNode("text",{class:"label-text"},"Á°ÆËÆ§ÂØÜÁ†Å")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[6]||(a[6]=e=>n.confirmPassword=e),password:!n.showConfirmPassword,placeholder:"ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å","placeholder-style":"color: #CCCCCC;"},null,8,["password"]),[[e.vModelText,n.confirmPassword]]),e.createElementVNode("text",{class:"password-toggle",onClick:a[7]||(a[7]=(...e)=>l.toggleConfirmPassword&&l.toggleConfirmPassword(...e))},e.toDisplayString(n.showConfirmPassword?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è"),1)]),e.createElementVNode("view",{class:"agreement-box",onClick:a[10]||(a[10]=(...e)=>l.toggleAgreement&&l.toggleAgreement(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["checkbox",{checked:n.agreedToTerms}])},e.toDisplayString(n.agreedToTerms?"‚òëÔ∏è":"‚¨ú"),3),e.createElementVNode("text",{class:"agreement-text"},[e.createTextVNode(" ÊàëÂ∑≤ÈòÖËØªÂπ∂ÂêåÊÑè "),e.createElementVNode("text",{class:"link-text",onClick:a[8]||(a[8]=e.withModifiers(((...e)=>l.showTerms&&l.showTerms(...e)),["stop"]))},"„ÄäÁî®Êà∑ÂçèËÆÆ„Äã"),e.createTextVNode(" Âíå "),e.createElementVNode("text",{class:"link-text",onClick:a[9]||(a[9]=e.withModifiers(((...e)=>l.showPrivacy&&l.showPrivacy(...e)),["stop"]))},"„ÄäÈöêÁßÅÊîøÁ≠ñ„Äã")])]),e.createElementVNode("button",{class:"register-btn btn-primary",onClick:a[11]||(a[11]=(...e)=>l.handleRegister&&l.handleRegister(...e))},"Ê≥®ÂÜå"),e.createElementVNode("view",{class:"login-tip"},[e.createElementVNode("text",{class:"tip-text"},"Â∑≤ÊúâË¥¶Âè∑Ôºü"),e.createElementVNode("text",{class:"login-link",onClick:a[12]||(a[12]=(...e)=>l.goLogin&&l.goLogin(...e))},"Á´ãÂç≥ÁôªÂΩï")])])])}],["__scopeId","data-v-4a6ee7da"]]);function h(e){return l(`/diary/${e}`)}function p(e){return l("/diary",e)}function g(){return l("/diary/stats/all")}function w(e){return function(e,t={}){return n(e,{method:"DELETE",...t})}(`/diary/${e}`)}const y=d({data:()=>({currentYear:2025,currentMonth:12,selectedDate:null,weekDays:["Êó•","‰∏Ä","‰∫å","‰∏â","Âõõ","‰∫î","ÂÖ≠"],calendarDates:[],diaryData:{}}),computed:{selectedDateText(){return this.selectedDate?`${this.selectedDate.year}Âπ¥${this.selectedDate.month}Êúà${this.selectedDate.day}Êó•`:""},selectedDiary(){if(!this.selectedDate)return null;const e=`${this.selectedDate.year}-${String(this.selectedDate.month).padStart(2,"0")}-${String(this.selectedDate.day).padStart(2,"0")}`;return this.diaryData[e]||null}},onLoad(){this.initCalendar()},onShow(){this.loadDiaryData()},methods:{initCalendar(){const e=new Date;this.currentYear=e.getFullYear(),this.currentMonth=e.getMonth()+1,this.selectedDate={year:this.currentYear,month:this.currentMonth,day:e.getDate()},this.loadDiaryData()},generateCalendar(){const e=[],t=new Date(this.currentYear,this.currentMonth-1,1),a=new Date(this.currentYear,this.currentMonth,0),s=t.getDay(),o=a.getDate(),n=new Date(this.currentYear,this.currentMonth-1,0).getDate();for(let c=s-1;c>=0;c--){const t=n-c,a=1===this.currentMonth?12:this.currentMonth-1,s=1===this.currentMonth?this.currentYear-1:this.currentYear;e.push({day:t,month:a,year:s,isCurrentMonth:!1,isToday:!1,isSelected:!1,hasDiary:this.checkHasDiary(s,a,t)})}const l=new Date;for(let c=1;c<=o;c++){const t=c===l.getDate()&&this.currentMonth===l.getMonth()+1&&this.currentYear===l.getFullYear(),a=this.selectedDate&&c===this.selectedDate.day&&this.currentMonth===this.selectedDate.month&&this.currentYear===this.selectedDate.year;e.push({day:c,month:this.currentMonth,year:this.currentYear,isCurrentMonth:!0,isToday:t,isSelected:a,hasDiary:this.checkHasDiary(this.currentYear,this.currentMonth,c)})}const i=42-e.length;for(let c=1;c<=i;c++){const t=12===this.currentMonth?1:this.currentMonth+1,a=12===this.currentMonth?this.currentYear+1:this.currentYear;e.push({day:c,month:t,year:a,isCurrentMonth:!1,isToday:!1,isSelected:!1,hasDiary:this.checkHasDiary(a,t,c)})}this.calendarDates=e},checkHasDiary(e,t,a){const s=`${e}-${String(t).padStart(2,"0")}-${String(a).padStart(2,"0")}`;return!!this.diaryData[s]},onDateClick(e){this.selectedDate={year:e.year,month:e.month,day:e.day},e.isCurrentMonth||(this.currentYear=e.year,this.currentMonth=e.month),this.generateCalendar()},prevMonth(){1===this.currentMonth?(this.currentMonth=12,this.currentYear--):this.currentMonth--,this.generateCalendar()},nextMonth(){12===this.currentMonth?(this.currentMonth=1,this.currentYear++):this.currentMonth++,this.generateCalendar()},goToday(){const e=new Date;this.currentYear=e.getFullYear(),this.currentMonth=e.getMonth()+1,this.selectedDate={year:this.currentYear,month:this.currentMonth,day:e.getDate()},this.generateCalendar()},async loadDiaryData(){try{const e=await p({showLoading:!1,showError:!1});t("log","at pages/index/index.vue:237","Âä†ËΩΩÁöÑÊó•ËÆ∞Êï∞ÊçÆ:",e),this.diaryData={},e.forEach((e=>{const a=e.diary_date;t("log","at pages/index/index.vue:243","Â§ÑÁêÜÊó•ËÆ∞Êó•Êúü:",a),this.diaryData[a]={content:e.content,mood:e.mood,weather:e.weather,updateTime:new Date(e.updated_at).getTime()}})),t("log","at pages/index/index.vue:252","Â§ÑÁêÜÂêéÁöÑÊó•ËÆ∞Êï∞ÊçÆ:",this.diaryData),this.generateCalendar()}catch(e){t("error","at pages/index/index.vue:257","Âä†ËΩΩÊó•ËÆ∞Êï∞ÊçÆÂ§±Ë¥•:",e),this.diaryData={},this.generateCalendar()}},writeDiary(){const e=`${this.selectedDate.year}-${String(this.selectedDate.month).padStart(2,"0")}-${String(this.selectedDate.day).padStart(2,"0")}`;uni.navigateTo({url:`/pages/write/write?date=${e}`})},editDiary(){const e=`${this.selectedDate.year}-${String(this.selectedDate.month).padStart(2,"0")}-${String(this.selectedDate.day).padStart(2,"0")}`;uni.navigateTo({url:`/pages/write/write?date=${e}&mode=edit`})},viewDiary(){const e=`${this.selectedDate.year}-${String(this.selectedDate.month).padStart(2,"0")}-${String(this.selectedDate.day).padStart(2,"0")}`;uni.navigateTo({url:`/pages/detail/detail?date=${e}`})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"month-selector"},[e.createElementVNode("text",{class:"icon-btn",onClick:a[0]||(a[0]=(...e)=>l.prevMonth&&l.prevMonth(...e))},"‚óÄ"),e.createElementVNode("text",{class:"month-text"},e.toDisplayString(n.currentYear)+"Âπ¥"+e.toDisplayString(n.currentMonth)+"Êúà",1),e.createElementVNode("text",{class:"icon-btn",onClick:a[1]||(a[1]=(...e)=>l.nextMonth&&l.nextMonth(...e))},"‚ñ∂")]),e.createElementVNode("view",{class:"today-btn",onClick:a[2]||(a[2]=(...e)=>l.goToday&&l.goToday(...e))},"‰ªäÂ§©")]),e.createElementVNode("view",{class:"calendar-container card"},[e.createElementVNode("view",{class:"week-header"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.weekDays,(t=>(e.openBlock(),e.createElementBlock("text",{class:"week-day",key:t},e.toDisplayString(t),1)))),128))]),e.createElementVNode("view",{class:"calendar-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.calendarDates,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"date-item",key:a,onClick:e=>l.onDateClick(t)},[e.createElementVNode("view",{class:e.normalizeClass(["date-content",{"other-month":!t.isCurrentMonth,today:t.isToday,selected:t.isSelected,"has-diary":t.hasDiary}])},[e.createElementVNode("text",{class:"date-num"},e.toDisplayString(t.day),1),t.hasDiary?(e.openBlock(),e.createElementBlock("view",{key:0,class:"diary-dot"})):e.createCommentVNode("",!0)],2)],8,["onClick"])))),128))])]),l.selectedDiary?(e.openBlock(),e.createElementBlock("view",{key:0,class:"diary-preview card"},[e.createElementVNode("view",{class:"diary-header"},[e.createElementVNode("text",{class:"diary-date"},e.toDisplayString(l.selectedDateText),1),e.createElementVNode("text",{class:"diary-mood"},e.toDisplayString(l.selectedDiary.mood),1)]),e.createElementVNode("text",{class:"diary-content"},e.toDisplayString(l.selectedDiary.content),1),e.createElementVNode("view",{class:"diary-actions"},[e.createElementVNode("button",{class:"action-btn",onClick:a[3]||(a[3]=(...e)=>l.viewDiary&&l.viewDiary(...e))},"Êü•ÁúãËØ¶ÊÉÖ"),e.createElementVNode("button",{class:"action-btn edit-btn",onClick:a[4]||(a[4]=(...e)=>l.editDiary&&l.editDiary(...e))},"ÁºñËæë")])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-preview card"},[e.createElementVNode("text",{class:"empty-text"},e.toDisplayString(l.selectedDateText),1),e.createElementVNode("text",{class:"empty-tip"},"ËøòÊ≤°ÊúâÂÜôÊó•ËÆ∞"),e.createElementVNode("button",{class:"btn-primary write-btn",onClick:a[5]||(a[5]=(...e)=>l.writeDiary&&l.writeDiary(...e))}," ‚úèÔ∏è ÂÜôÊó•ËÆ∞ ")])),e.createElementVNode("view",{class:"float-btn",onClick:a[6]||(a[6]=(...e)=>l.writeDiary&&l.writeDiary(...e))},[e.createElementVNode("text",{class:"float-icon"},"‚úèÔ∏è")])])}],["__scopeId","data-v-2587cb81"]]);const k=d({data:()=>({dateStr:"",dateText:"",weekText:"",selectedMood:"üòä",selectedWeather:"‚òÄÔ∏è",content:"",images:[],videos:[],uploading:!1,mode:"new",moods:[{emoji:"üòä",label:"ÂºÄÂøÉ"},{emoji:"üòÑ",label:"Âø´‰πê"},{emoji:"üòå",label:"Âπ≥Èùô"},{emoji:"üòî",label:"Â§±ËêΩ"},{emoji:"üò¢",label:"ÈöæËøá"},{emoji:"üò°",label:"ÁîüÊ∞î"},{emoji:"üò¥",label:"Âõ∞ÂÄ¶"},{emoji:"ü§î",label:"ÊÄùËÄÉ"}],weathers:[{emoji:"‚òÄÔ∏è",label:"Êô¥Â§©"},{emoji:"‚õÖ",label:"Â§ö‰∫ë"},{emoji:"‚òÅÔ∏è",label:"Èò¥Â§©"},{emoji:"üåßÔ∏è",label:"Èõ®Â§©"},{emoji:"‚õàÔ∏è",label:"Èõ∑Èõ®"},{emoji:"üå®Ô∏è",label:"‰∏ãÈõ™"},{emoji:"üå´Ô∏è",label:"ÈõæÈúæ"},{emoji:"üå™Ô∏è",label:"Â§ßÈ£é"}]}),onLoad(e){if(e.date)this.dateStr=e.date,this.mode=e.mode||"new",this.formatDate(),"edit"===this.mode&&this.loadDiary();else{const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,s=e.getDate();this.dateStr=`${t}-${a}-${s}`,this.formatDate()}},methods:{formatDate(){const[e,t,a]=this.dateStr.split("-"),s=new Date(e,t-1,a);this.dateText=`${e}Âπ¥${t}Êúà${a}Êó•`,this.weekText=["ÊòüÊúüÊó•","ÊòüÊúü‰∏Ä","ÊòüÊúü‰∫å","ÊòüÊúü‰∏â","ÊòüÊúüÂõõ","ÊòüÊúü‰∫î","ÊòüÊúüÂÖ≠"][s.getDay()]},async loadDiary(){try{const e=await h(this.dateStr);this.content=e.content||"",this.selectedMood=e.mood||"üòä",this.selectedWeather=e.weather||"‚òÄÔ∏è",this.images=e.images||[],this.videos=e.videos||[]}catch(e){t("log","at pages/write/write.vue:191","Êó•ËÆ∞‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Êñ∞Êó•ËÆ∞")}},selectMood(e){this.selectedMood=e},selectWeather(e){this.selectedWeather=e},showMediaPicker(){uni.showActionSheet({itemList:["ÈÄâÊã©ÂõæÁâá","ÈÄâÊã©ËßÜÈ¢ë"],success:e=>{0===e.tapIndex?this.chooseImage():1===e.tapIndex&&this.chooseVideo()}})},chooseImage(){const e=9-this.images.length-this.videos.length;e<=0?uni.showToast({title:"ÊúÄÂ§ö‰∏ä‰º†9‰∏™Êñá‰ª∂",icon:"none"}):uni.chooseImage({count:e,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{this.uploadFiles(e.tempFilePaths,"image")}})},chooseVideo(){9-this.images.length-this.videos.length<=0?uni.showToast({title:"ÊúÄÂ§ö‰∏ä‰º†9‰∏™Êñá‰ª∂",icon:"none"}):uni.chooseVideo({sourceType:["album","camera"],maxDuration:60,camera:"back",success:e=>{this.uploadFiles([e.tempFilePath],"video")}})},async uploadFiles(e,a){this.uploading=!0;try{for(let t of e){const e=await this.uploadSingleFile(t);"image"===a?this.images.push(e.url):this.videos.push(e.url)}uni.showToast({title:"‰∏ä‰º†ÊàêÂäü",icon:"success"})}catch(s){t("error","at pages/write/write.vue:278","‰∏ä‰º†Â§±Ë¥•:",s),uni.showToast({title:"‰∏ä‰º†Â§±Ë¥•",icon:"none"})}finally{this.uploading=!1}},uploadSingleFile:e=>new Promise(((t,s)=>{const o=uni.getStorageSync("userToken");uni.uploadFile({url:a+"/upload/single",filePath:e,name:"file",header:{Authorization:`Bearer ${o}`},success:e=>{const a=JSON.parse(e.data);200===a.code?t(a.data):s(new Error(a.message))},fail:e=>{s(e)}})})),deleteImage(e){uni.showModal({title:"ÊèêÁ§∫",content:"Á°ÆÂÆöÂà†Èô§ËøôÂº†ÂõæÁâáÂêóÔºü",success:t=>{t.confirm&&this.images.splice(e,1)}})},deleteVideo(e){uni.showModal({title:"ÊèêÁ§∫",content:"Á°ÆÂÆöÂà†Èô§Ëøô‰∏™ËßÜÈ¢ëÂêóÔºü",success:t=>{t.confirm&&this.videos.splice(e,1)}})},getFullUrl:e=>e?e.startsWith("http")?e:a.replace("/api","")+e:"",cancel(){uni.navigateBack()},async save(){var e;if(this.content.trim())if(this.uploading)uni.showToast({title:"Êñá‰ª∂‰∏ä‰º†‰∏≠ÔºåËØ∑Á®çÂÄô",icon:"none"});else try{await(e={date:this.dateStr,content:this.content,mood:this.selectedMood,weather:this.selectedWeather,images:this.images,videos:this.videos},i("/diary/save",e)),uni.showToast({title:"‰øùÂ≠òÊàêÂäü",icon:"success",duration:1500}),setTimeout((()=>{uni.navigateBack()}),1500)}catch(a){t("error","at pages/write/write.vue:393","‰øùÂ≠òÊó•ËÆ∞Â§±Ë¥•:",a)}else uni.showToast({title:"ËØ∑ËæìÂÖ•Êó•ËÆ∞ÂÜÖÂÆπ",icon:"none"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"date-header card"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(n.dateText),1),e.createElementVNode("text",{class:"week-text"},e.toDisplayString(n.weekText),1)]),e.createElementVNode("view",{class:"mood-section card"},[e.createElementVNode("text",{class:"section-title"},"‰ªäÂ§©ÂøÉÊÉÖ"),e.createElementVNode("view",{class:"mood-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.moods,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["mood-item",{active:n.selectedMood===t.emoji}]),key:a,onClick:e=>l.selectMood(t.emoji)},[e.createElementVNode("text",{class:"mood-emoji"},e.toDisplayString(t.emoji),1),e.createElementVNode("text",{class:"mood-label"},e.toDisplayString(t.label),1)],10,["onClick"])))),128))])]),e.createElementVNode("view",{class:"content-section card"},[e.createElementVNode("text",{class:"section-title"},"ËÆ∞ÂΩïÊ≠§Âàª"),e.withDirectives(e.createElementVNode("textarea",{class:"diary-textarea","onUpdate:modelValue":a[0]||(a[0]=e=>n.content=e),placeholder:"ÂÜô‰∏ã‰ªäÂ§©ÂèëÁîüÁöÑ‰∫ãÊÉÖ...","placeholder-style":"color: #CCCCCC;",maxlength:5e3,"auto-height":!0,"cursor-spacing":50},null,512),[[e.vModelText,n.content]]),e.createElementVNode("view",{class:"word-count"},[e.createElementVNode("text",{class:"count-text"},e.toDisplayString(n.content.length)+"/5000",1)])]),e.createElementVNode("view",{class:"media-section card"},[e.createElementVNode("text",{class:"section-title"},"Ê∑ªÂä†ÂõæÁâá/ËßÜÈ¢ë"),e.createElementVNode("view",{class:"media-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.images,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"media-item",key:"img-"+a},[e.createElementVNode("image",{class:"media-preview",src:l.getFullUrl(t),mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"media-delete",onClick:e=>l.deleteImage(a)},[e.createElementVNode("text",{class:"delete-icon"},"√ó")],8,["onClick"])])))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.videos,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"media-item",key:"video-"+a},[e.createElementVNode("video",{class:"media-preview",src:l.getFullUrl(t),"show-center-play-btn":!0},null,8,["src"]),e.createElementVNode("view",{class:"media-delete",onClick:e=>l.deleteVideo(a)},[e.createElementVNode("text",{class:"delete-icon"},"√ó")],8,["onClick"]),e.createElementVNode("view",{class:"video-badge"},[e.createElementVNode("text",{class:"badge-text"},"üìπ")])])))),128)),n.images.length+n.videos.length<9?(e.openBlock(),e.createElementBlock("view",{key:0,class:"upload-btn",onClick:a[1]||(a[1]=(...e)=>l.showMediaPicker&&l.showMediaPicker(...e))},[e.createElementVNode("text",{class:"upload-icon"},"+"),e.createElementVNode("text",{class:"upload-text"},"Ê∑ªÂä†")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"media-tip"},[e.createElementVNode("text",{class:"tip-text"},"ÊúÄÂ§öÂèØ‰∏ä‰º†9Âº†ÂõæÁâáÊàñËßÜÈ¢ë")])]),e.createElementVNode("view",{class:"weather-section card"},[e.createElementVNode("text",{class:"section-title"},"‰ªäÊó•Â§©Ê∞î"),e.createElementVNode("view",{class:"weather-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.weathers,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["weather-item",{active:n.selectedWeather===t.emoji}]),key:a,onClick:e=>l.selectWeather(t.emoji)},[e.createElementVNode("text",{class:"weather-emoji"},e.toDisplayString(t.emoji),1),e.createElementVNode("text",{class:"weather-label"},e.toDisplayString(t.label),1)],10,["onClick"])))),128))])]),e.createElementVNode("view",{class:"bottom-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:a[2]||(a[2]=(...e)=>l.cancel&&l.cancel(...e))},"ÂèñÊ∂à"),e.createElementVNode("button",{class:"save-btn btn-primary",onClick:a[3]||(a[3]=(...e)=>l.save&&l.save(...e)),disabled:n.uploading},e.toDisplayString(n.uploading?"‰∏ä‰º†‰∏≠...":"‰øùÂ≠ò"),9,["disabled"])])])}],["__scopeId","data-v-f17ac7b4"]]);const E=d({data:()=>({dateStr:"",dateText:"",weekText:"",updateTimeText:"",diary:{content:"",mood:"üòä",weather:"‚òÄÔ∏è",images:[],videos:[],updateTime:0}}),onLoad(e){e.date&&(this.dateStr=e.date,this.formatDate(),this.loadDiary())},methods:{formatDate(){const[e,t,a]=this.dateStr.split("-"),s=new Date(e,t-1,a);this.dateText=`${e}Âπ¥${t}Êúà${a}Êó•`,this.weekText=["ÊòüÊúüÊó•","ÊòüÊúü‰∏Ä","ÊòüÊúü‰∫å","ÊòüÊúü‰∏â","ÊòüÊúüÂõõ","ÊòüÊúü‰∫î","ÊòüÊúüÂÖ≠"][s.getDay()]},async loadDiary(){try{const e=await h(this.dateStr);this.diary={content:e.content,mood:e.mood,weather:e.weather,images:e.images||[],videos:e.videos||[],updateTime:new Date(e.updated_at).getTime()},this.formatUpdateTime()}catch(e){t("error","at pages/detail/detail.vue:124","Âä†ËΩΩÊó•ËÆ∞Â§±Ë¥•:",e),uni.showToast({title:"Êó•ËÆ∞‰∏çÂ≠òÂú®",icon:"none"}),setTimeout((()=>{uni.navigateBack()}),1500)}},formatUpdateTime(){if(!this.diary.updateTime)return void(this.updateTimeText="Êú™Áü•");const e=new Date(this.diary.updateTime),t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");this.updateTimeText=`${t}-${a}-${s} ${o}:${n}`},getFullUrl(e,t=!0){if(!e)return"";if(e.startsWith("http")&&e.includes("aliyuncs.com")){if(t){return`${e.split("?")[0]}?x-oss-process=image/resize,w_400/quality,q_80/format,webp`}return e}return e.startsWith("http")?e:a.replace("/api","")+e},getOriginalUrl(e){return this.getFullUrl(e,!1)},getVideoThumbnail(e){if(!e)return"";if(e.startsWith("http")&&e.includes("aliyuncs.com")){return`${e.split("?")[0]}?x-oss-process=video/snapshot,t_1000,f_jpg,w_400,h_300,m_fast`}return e},previewImage(e){const t=this.diary.images.map((e=>this.getOriginalUrl(e)));uni.previewImage({current:e,urls:t})},editDiary(){uni.navigateTo({url:`/pages/write/write?date=${this.dateStr}&mode=edit`})},deleteDiary(){uni.showModal({title:"ÊèêÁ§∫",content:"Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÁØáÊó•ËÆ∞ÂêóÔºü",confirmColor:"#E53E3E",success:async e=>{if(e.confirm)try{await w(this.dateStr),uni.showToast({title:"Âà†Èô§ÊàêÂäü",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)}catch(a){t("error","at pages/detail/detail.vue:228","Âà†Èô§Êó•ËÆ∞Â§±Ë¥•:",a)}}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"header-section"},[e.createElementVNode("view",{class:"date-box"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(n.dateText),1),e.createElementVNode("text",{class:"week-text"},e.toDisplayString(n.weekText),1)]),e.createElementVNode("view",{class:"meta-info"},[e.createElementVNode("view",{class:"meta-item"},[e.createElementVNode("text",{class:"meta-emoji"},e.toDisplayString(n.diary.mood),1),e.createElementVNode("text",{class:"meta-label"},"ÂøÉÊÉÖ")]),e.createElementVNode("view",{class:"meta-item"},[e.createElementVNode("text",{class:"meta-emoji"},e.toDisplayString(n.diary.weather),1),e.createElementVNode("text",{class:"meta-label"},"Â§©Ê∞î")])])]),e.createElementVNode("view",{class:"content-section card"},[e.createElementVNode("text",{class:"content-text"},e.toDisplayString(n.diary.content),1),n.diary.images&&n.diary.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"media-section"},[e.createElementVNode("view",{class:"image-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.diary.images,((t,a)=>(e.openBlock(),e.createElementBlock("image",{class:"diary-image",key:"img-"+a,src:l.getFullUrl(t,!0),mode:"aspectFill",onClick:e=>l.previewImage(a)},null,8,["src","onClick"])))),128))])])):e.createCommentVNode("",!0),n.diary.videos&&n.diary.videos.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"media-section"},[e.createElementVNode("view",{class:"video-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.diary.videos,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"video-wrapper",key:"video-"+a},[e.createElementVNode("video",{class:"diary-video",src:l.getFullUrl(t,!1),poster:l.getVideoThumbnail(t),controls:!0,"show-center-play-btn":!0,"enable-progress-gesture":!0},null,8,["src","poster"])])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"update-time"},[e.createElementVNode("text",{class:"time-text"},"ÊúÄÂêéÁºñËæë‰∫é "+e.toDisplayString(n.updateTimeText),1)])]),e.createElementVNode("view",{class:"bottom-actions"},[e.createElementVNode("button",{class:"action-btn delete-btn",onClick:a[0]||(a[0]=(...e)=>l.deleteDiary&&l.deleteDiary(...e))}," üóëÔ∏è Âà†Èô§ "),e.createElementVNode("button",{class:"action-btn edit-btn btn-primary",onClick:a[1]||(a[1]=(...e)=>l.editDiary&&l.editDiary(...e))}," ‚úèÔ∏è ÁºñËæë ")])])}],["__scopeId","data-v-40fd9c4a"]]);const v=d({data:()=>({diaryList:[],stats:{totalDays:0,totalWords:0,continuousDays:0},selectedYear:null,selectedMonth:null,selectedMood:null,showYearPicker:!1,showMonthPicker:!1,showMoodPicker:!1,yearPickerIndex:0,monthPickerIndex:0,moodPickerIndex:0,yearList:[],monthList:[{label:"ÂÖ®ÈÉ®",value:null},{label:"1Êúà",value:1},{label:"2Êúà",value:2},{label:"3Êúà",value:3},{label:"4Êúà",value:4},{label:"5Êúà",value:5},{label:"6Êúà",value:6},{label:"7Êúà",value:7},{label:"8Êúà",value:8},{label:"9Êúà",value:9},{label:"10Êúà",value:10},{label:"11Êúà",value:11},{label:"12Êúà",value:12}],moodList:[{label:"ÂÖ®ÈÉ®",value:null},{label:"üòä ÂºÄÂøÉ",value:"üòä"},{label:"üò¢ ÈöæËøá",value:"üò¢"},{label:"üò§ ÁîüÊ∞î",value:"üò§"},{label:"üò¥ Áñ≤ÊÉ´",value:"üò¥"},{label:"üòç ÂÖ¥Â•ã",value:"üòç"},{label:"üòå Âπ≥Èùô",value:"üòå"},{label:"üò∞ ÁÑ¶Ëôë",value:"üò∞"},{label:"ü§î ÊÄùËÄÉ",value:"ü§î"}]}),onLoad(){this.initYearList(),this.loadData()},onShow(){this.loadData()},methods:{initYearList(){const e=(new Date).getFullYear();this.yearList=["ÂÖ®ÈÉ®"];for(let t=e;t>=e-10;t--)this.yearList.push(t)},async loadData(){await Promise.all([this.loadDiaryList(),this.loadStats()])},async loadDiaryList(){try{const e={};this.selectedYear&&"ÂÖ®ÈÉ®"!==this.selectedYear&&(e.year=this.selectedYear),this.selectedMonth&&(e.month=this.selectedMonth);let t=await p(e);this.selectedMood&&(t=t.filter((e=>e.mood===this.selectedMood))),this.diaryList=t}catch(e){t("error","at pages/list/list.vue:237","Âä†ËΩΩÊó•ËÆ∞ÂàóË°®Â§±Ë¥•:",e),uni.showToast({title:"Âä†ËΩΩÂ§±Ë¥•",icon:"none"})}},async loadStats(){try{this.stats=await g()}catch(e){t("error","at pages/list/list.vue:250","Âä†ËΩΩÁªüËÆ°‰ø°ÊÅØÂ§±Ë¥•:",e)}},onYearChange(e){this.yearPickerIndex=e.detail.value[0];const t=this.yearList[this.yearPickerIndex];this.selectedYear="ÂÖ®ÈÉ®"===t?null:t,this.showYearPicker=!1},onMonthChange(e){this.monthPickerIndex=e.detail.value[0],this.selectedMonth=this.monthList[this.monthPickerIndex].value,this.showMonthPicker=!1},onMoodChange(e){this.moodPickerIndex=e.detail.value[0],this.selectedMood=this.moodList[this.moodPickerIndex].value,this.showMoodPicker=!1},closeAllPickers(){this.showYearPicker=!1,this.showMonthPicker=!1,this.showMoodPicker=!1},applyFilters(){this.loadDiaryList()},resetFilters(){this.selectedYear=null,this.selectedMonth=null,this.selectedMood=null,this.yearPickerIndex=0,this.monthPickerIndex=0,this.moodPickerIndex=0,this.loadDiaryList()},viewDiary(e){uni.navigateTo({url:`/pages/detail/detail?date=${e.diary_date}`})},formatDateText(e){const t=new Date(e);return`${t.getMonth()+1}Êúà${t.getDate()}Êó•`},getWeekDay:e=>["Âë®Êó•","Âë®‰∏Ä","Âë®‰∫å","Âë®‰∏â","Âë®Âõõ","Âë®‰∫î","Âë®ÂÖ≠"][new Date(e).getDay()],formatWords:e=>e>=1e4?(e/1e4).toFixed(1)+"‰∏á":e,getCompressedUrl:e=>e?e.includes("aliyuncs.com")?e+"?x-oss-process=image/resize,w_200/quality,q_80/format,webp":e:""}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"filter-section card"},[e.createElementVNode("view",{class:"filter-row"},[e.createElementVNode("view",{class:"filter-item",onClick:a[0]||(a[0]=e=>n.showYearPicker=!0)},[e.createElementVNode("text",{class:"filter-label"},"Âπ¥‰ªΩ"),e.createElementVNode("view",{class:"filter-value"},[e.createElementVNode("text",null,e.toDisplayString(n.selectedYear||"ÂÖ®ÈÉ®"),1),e.createElementVNode("text",{class:"arrow"},"‚ñº")])]),e.createElementVNode("view",{class:"filter-item",onClick:a[1]||(a[1]=e=>n.showMonthPicker=!0)},[e.createElementVNode("text",{class:"filter-label"},"Êúà‰ªΩ"),e.createElementVNode("view",{class:"filter-value"},[e.createElementVNode("text",null,e.toDisplayString(n.selectedMonth?n.selectedMonth+"Êúà":"ÂÖ®ÈÉ®"),1),e.createElementVNode("text",{class:"arrow"},"‚ñº")])]),e.createElementVNode("view",{class:"filter-item",onClick:a[2]||(a[2]=e=>n.showMoodPicker=!0)},[e.createElementVNode("text",{class:"filter-label"},"ÂøÉÊÉÖ"),e.createElementVNode("view",{class:"filter-value"},[e.createElementVNode("text",null,e.toDisplayString(n.selectedMood||"ÂÖ®ÈÉ®"),1),e.createElementVNode("text",{class:"arrow"},"‚ñº")])])]),e.createElementVNode("view",{class:"filter-actions"},[e.createElementVNode("button",{class:"reset-btn",onClick:a[3]||(a[3]=(...e)=>l.resetFilters&&l.resetFilters(...e))},"ÈáçÁΩÆ"),e.createElementVNode("button",{class:"search-btn",onClick:a[4]||(a[4]=(...e)=>l.applyFilters&&l.applyFilters(...e))},"Á≠õÈÄâ")])]),e.createElementVNode("view",{class:"stats-section card"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.stats.totalDays),1),e.createElementVNode("text",{class:"stat-label"},"ËÆ∞ÂΩïÂ§©Êï∞")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(l.formatWords(n.stats.totalWords)),1),e.createElementVNode("text",{class:"stat-label"},"ÊÄªÂ≠óÊï∞")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.stats.continuousDays),1),e.createElementVNode("text",{class:"stat-label"},"ËøûÁª≠Â§©Êï∞")])]),e.createElementVNode("view",{class:"diary-list"},[0===n.diaryList.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"üìñ"),e.createElementVNode("text",{class:"empty-text"},"ÊöÇÊó†Êó•ËÆ∞"),e.createElementVNode("text",{class:"empty-tip"},"Âø´ÂéªÂÜô‰∏ÄÁØáÂêßÔΩû")])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.diaryList,(t=>(e.openBlock(),e.createElementBlock("view",{class:"diary-item card",key:t.id,onClick:e=>l.viewDiary(t)},[e.createElementVNode("view",{class:"diary-header"},[e.createElementVNode("view",{class:"date-info"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(l.formatDateText(t.diary_date)),1),e.createElementVNode("text",{class:"week-text"},e.toDisplayString(l.getWeekDay(t.diary_date)),1)]),e.createElementVNode("view",{class:"mood-weather"},[e.createElementVNode("text",{class:"mood-icon"},e.toDisplayString(t.mood),1),e.createElementVNode("text",{class:"weather-icon"},e.toDisplayString(t.weather),1)])]),e.createElementVNode("text",{class:"diary-content"},e.toDisplayString(t.content),1),t.images.length>0||t.videos.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"media-preview"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.images.slice(0,3),((t,a)=>(e.openBlock(),e.createElementBlock("image",{key:"img"+a,src:l.getCompressedUrl(t),class:"media-thumb",mode:"aspectFill"},null,8,["src"])))),128)),t.images.length+t.videos.length>3?(e.openBlock(),e.createElementBlock("view",{key:0,class:"more-media"},[e.createElementVNode("text",null,"+"+e.toDisplayString(t.images.length+t.videos.length-3),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],8,["onClick"])))),128))]),n.showYearPicker?(e.openBlock(),e.createElementBlock("picker-view",{key:0,class:"picker-modal",value:[n.yearPickerIndex],onChange:a[5]||(a[5]=(...e)=>l.onYearChange&&l.onYearChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.yearList,(t=>(e.openBlock(),e.createElementBlock("view",{key:t,class:"picker-item"},e.toDisplayString(t)+"Âπ¥ ",1)))),128))])],40,["value"])):e.createCommentVNode("",!0),n.showMonthPicker?(e.openBlock(),e.createElementBlock("picker-view",{key:1,class:"picker-modal",value:[n.monthPickerIndex],onChange:a[6]||(a[6]=(...e)=>l.onMonthChange&&l.onMonthChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.monthList,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.value,class:"picker-item"},e.toDisplayString(t.label),1)))),128))])],40,["value"])):e.createCommentVNode("",!0),n.showMoodPicker?(e.openBlock(),e.createElementBlock("picker-view",{key:2,class:"picker-modal",value:[n.moodPickerIndex],onChange:a[7]||(a[7]=(...e)=>l.onMoodChange&&l.onMoodChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.moodList,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.value,class:"picker-item"},e.toDisplayString(t.label),1)))),128))])],40,["value"])):e.createCommentVNode("",!0),n.showYearPicker||n.showMonthPicker||n.showMoodPicker?(e.openBlock(),e.createElementBlock("view",{key:3,class:"picker-mask",onClick:a[8]||(a[8]=(...e)=>l.closeAllPickers&&l.closeAllPickers(...e))})):e.createCommentVNode("",!0)])}],["__scopeId","data-v-78459ddb"]]);function V(){uni.removeStorageSync("userToken"),uni.removeStorageSync("userInfo"),uni.removeStorageSync("currentUser"),uni.showToast({title:"Â∑≤ÈÄÄÂá∫ÁôªÂΩï",icon:"success",duration:1500}),setTimeout((()=>{uni.reLaunch({url:"/pages/login/login"})}),1500)}const N=d({data:()=>({userInfo:{},totalDays:0,continuousDays:0,totalWords:0,isVip:!1}),onShow(){this.loadUserInfo(),this.loadStats()},methods:{async loadUserInfo(){try{const e=await c();this.userInfo=e,uni.setStorageSync("userInfo",e)}catch(e){t("error","at pages/mine/mine.vue:161","Âä†ËΩΩÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:",e),this.userInfo=function(){const e=uni.getStorageSync("userInfo");if(e)try{return JSON.parse(e)}catch(a){return t("error","at utils/auth.js:29","Ëß£ÊûêÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•",a),null}return null}()||{}}},formatPhone:e=>e&&11===e.length?e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):e,async loadStats(){try{const e=await g();this.totalDays=e.totalDays||0,this.totalWords=e.totalWords||0,this.continuousDays=e.continuousDays||0}catch(e){t("error","at pages/mine/mine.vue:184","Âä†ËΩΩÁªüËÆ°Êï∞ÊçÆÂ§±Ë¥•:",e),this.totalDays=0,this.totalWords=0,this.continuousDays=0}},viewAllDiaries(){uni.navigateTo({url:"/pages/list/list"})},searchDiary(){uni.navigateTo({url:"/pages/search/search"})},showMoodStats(){uni.navigateTo({url:"/pages/stats/stats"})},editProfile(){uni.navigateTo({url:"/pages/profile/profile"})},changePassword(){uni.showModal({title:"‰øÆÊîπÂØÜÁ†Å",editable:!0,placeholderText:"ËØ∑ËæìÂÖ•Êñ∞ÂØÜÁ†ÅÔºàËá≥Â∞ë6‰ΩçÔºâ",success:e=>{if(e.confirm&&e.content){if(e.content.length<6)return void uni.showToast({title:"ÂØÜÁ†ÅÈïøÂ∫¶‰∏çËÉΩÂ∞ë‰∫é6‰Ωç",icon:"none"});uni.showToast({title:"ÂäüËÉΩÂºÄÂèë‰∏≠ÔºåËØ∑Âà∞ËÆæÁΩÆÈ°µÈù¢‰øÆÊîπ",icon:"none"})}}})},setReminder(){uni.navigateTo({url:"/pages/reminder/reminder"})},backup(){uni.navigateTo({url:"/pages/backup/backup"})},about(){uni.showModal({title:"ÂÖ≥‰∫éÂ∫îÁî®",content:"ÊØèÊó•Êó•ËÆ∞ v1.0.0\nËÆ∞ÂΩïÁîüÊ¥ªÔºåÁïô‰ΩèÁæéÂ•ΩÊó∂ÂÖâ",showCancel:!1})},handleLogout(){uni.showModal({title:"ÊèêÁ§∫",content:"Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁôªÂΩïÂêóÔºü",success:e=>{e.confirm&&V()}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"user-card"},[e.createElementVNode("view",{class:"user-header"},[e.createElementVNode("view",{class:"avatar-box",onClick:a[0]||(a[0]=(...e)=>l.editProfile&&l.editProfile(...e))},[n.userInfo.avatar&&(n.userInfo.avatar.startsWith("http")||n.userInfo.avatar.startsWith("blob:")||n.userInfo.avatar.startsWith("/")||n.userInfo.avatar.startsWith("data:"))?(e.openBlock(),e.createElementBlock("image",{key:0,src:n.userInfo.avatar,class:"avatar-image",mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"avatar-emoji"},e.toDisplayString(n.userInfo.avatar||"üìù"),1)),e.createElementVNode("view",{class:"edit-badge"},[e.createElementVNode("text",{class:"edit-icon"},"‚úèÔ∏è")])]),e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("view",{class:"user-name-row"},[e.createElementVNode("text",{class:"user-name"},e.toDisplayString(n.userInfo.nickname||"Êó•ËÆ∞Áî®Êà∑"),1),n.isVip?(e.openBlock(),e.createElementBlock("text",{key:0,class:"vip-badge"},"VIP")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"user-desc"},"@"+e.toDisplayString(n.userInfo.username||"user"),1),n.userInfo.email||n.userInfo.phone?(e.openBlock(),e.createElementBlock("view",{key:0,class:"user-detail"},[n.userInfo.email?(e.openBlock(),e.createElementBlock("text",{key:0,class:"detail-item"},"üìß "+e.toDisplayString(n.userInfo.email),1)):e.createCommentVNode("",!0),n.userInfo.phone?(e.openBlock(),e.createElementBlock("text",{key:1,class:"detail-item"},"üì± "+e.toDisplayString(l.formatPhone(n.userInfo.phone)),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"stats-section"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.totalDays),1),e.createElementVNode("text",{class:"stat-label"},"ÊÄªÂ§©Êï∞")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.continuousDays),1),e.createElementVNode("text",{class:"stat-label"},"ËøûÁª≠Â§©Êï∞")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.totalWords),1),e.createElementVNode("text",{class:"stat-label"},"ÊÄªÂ≠óÊï∞")])]),e.createElementVNode("view",{class:"menu-section card"},[e.createElementVNode("view",{class:"menu-item",onClick:a[1]||(a[1]=(...e)=>l.viewAllDiaries&&l.viewAllDiaries(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"üìö"),e.createElementVNode("text",{class:"menu-text"},"ÂÖ®ÈÉ®Êó•ËÆ∞")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")]),e.createElementVNode("view",{class:"menu-item",onClick:a[2]||(a[2]=(...e)=>l.searchDiary&&l.searchDiary(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"üîç"),e.createElementVNode("text",{class:"menu-text"},"ÊêúÁ¥¢Êó•ËÆ∞")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")]),e.createElementVNode("view",{class:"menu-item",onClick:a[3]||(a[3]=(...e)=>l.showMoodStats&&l.showMoodStats(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"üìä"),e.createElementVNode("text",{class:"menu-text"},"ÂøÉÊÉÖÁªüËÆ°")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")])]),e.createElementVNode("view",{class:"menu-section card"},[e.createElementVNode("view",{class:"menu-item",onClick:a[4]||(a[4]=(...e)=>l.editProfile&&l.editProfile(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"üë§"),e.createElementVNode("text",{class:"menu-text"},"ÁºñËæëËµÑÊñô")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")]),e.createElementVNode("view",{class:"menu-item",onClick:a[5]||(a[5]=(...e)=>l.changePassword&&l.changePassword(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"üîë"),e.createElementVNode("text",{class:"menu-text"},"‰øÆÊîπÂØÜÁ†Å")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")]),e.createElementVNode("view",{class:"menu-item",onClick:a[6]||(a[6]=(...e)=>l.setReminder&&l.setReminder(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"‚è∞"),e.createElementVNode("text",{class:"menu-text"},"ÂÜôÊó•ËÆ∞ÊèêÈÜí")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")]),e.createElementVNode("view",{class:"menu-item",onClick:a[7]||(a[7]=(...e)=>l.backup&&l.backup(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"‚òÅÔ∏è"),e.createElementVNode("text",{class:"menu-text"},"Â§á‰ªΩ‰∏éÊÅ¢Â§ç")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")]),e.createElementVNode("view",{class:"menu-item",onClick:a[8]||(a[8]=(...e)=>l.about&&l.about(...e))},[e.createElementVNode("view",{class:"menu-left"},[e.createElementVNode("text",{class:"menu-icon"},"‚ÑπÔ∏è"),e.createElementVNode("text",{class:"menu-text"},"ÂÖ≥‰∫éÂ∫îÁî®")]),e.createElementVNode("text",{class:"menu-arrow"},"‚Ä∫")])]),e.createElementVNode("view",{class:"logout-section"},[e.createElementVNode("button",{class:"logout-btn",onClick:a[9]||(a[9]=(...e)=>l.handleLogout&&l.handleLogout(...e))},"ÈÄÄÂá∫ÁôªÂΩï")]),e.createElementVNode("view",{class:"version-info"},[e.createElementVNode("text",{class:"version-text"},"ÁâàÊú¨ 1.0.0")])])}],["__scopeId","data-v-6a93620c"]]);function x(e={}){return new Promise(((t,s)=>{uni.chooseImage({count:e.count||1,sizeType:e.sizeType||["compressed"],sourceType:e.sourceType||["album","camera"],success:async e=>{try{const s=e.tempFilePaths[0],o=await function(e){return new Promise(((t,s)=>{const o=uni.getStorageSync("userToken");o?(uni.showLoading({title:"‰∏ä‰º†‰∏≠...",mask:!0}),uni.uploadFile({url:a+"/upload/single",filePath:e,name:"file",header:{Authorization:`Bearer ${o}`},success:e=>{try{const a=JSON.parse(e.data);200===a.code?t(a.data):s(new Error(a.message||"‰∏ä‰º†Â§±Ë¥•"))}catch(a){s(new Error("Ëß£ÊûêÂìçÂ∫îÂ§±Ë¥•"))}},fail:e=>{s(e)},complete:()=>{uni.hideLoading()}})):s(new Error("ËØ∑ÂÖàÁôªÂΩï"))}))}(s);t(o)}catch(o){s(o)}},fail:e=>{s(e)}})}))}const f=d({data:()=>({userInfo:{},formData:{nickname:"",email:"",phone:"",avatar:""}}),onLoad(){this.loadUserInfo()},methods:{async loadUserInfo(){try{if(!uni.getStorageSync("userToken"))return uni.showToast({title:"ËØ∑ÂÖàÁôªÂΩï",icon:"none"}),void setTimeout((()=>{uni.reLaunch({url:"/pages/login/login"})}),1500);this.userInfo=await c(),this.formData={nickname:this.userInfo.nickname||"",email:this.userInfo.email||"",phone:this.userInfo.phone||"",avatar:this.userInfo.avatar||""}}catch(e){t("error","at pages/profile/profile.vue:116","Âä†ËΩΩÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:",e),uni.showToast({title:"Âä†ËΩΩÂ§±Ë¥•",icon:"none"})}},async chooseAvatar(){try{const e=await x({count:1,sizeType:["compressed"],sourceType:["album","camera"]});this.formData.avatar=e.url,uni.showToast({title:"Â§¥ÂÉè‰∏ä‰º†ÊàêÂäü",icon:"success"})}catch(e){t("error","at pages/profile/profile.vue:141","‰∏ä‰º†Â§¥ÂÉèÂ§±Ë¥•:",e),uni.showToast({title:e.message||"‰∏ä‰º†Â§±Ë¥•",icon:"none"})}},async saveProfile(){if(!this.formData.email||this.isValidEmail(this.formData.email))if(!this.formData.phone||this.isValidPhone(this.formData.phone))try{uni.showLoading({title:"‰øùÂ≠ò‰∏≠..."}),await r(this.formData),uni.hideLoading(),uni.showToast({title:"‰øùÂ≠òÊàêÂäü",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)}catch(e){uni.hideLoading(),t("error","at pages/profile/profile.vue:186","‰øùÂ≠òÂ§±Ë¥•:",e),uni.showToast({title:e.message||"‰øùÂ≠òÂ§±Ë¥•",icon:"none"})}else uni.showToast({title:"ÊâãÊú∫Âè∑Ê†ºÂºè‰∏çÊ≠£Á°Æ",icon:"none"});else uni.showToast({title:"ÈÇÆÁÆ±Ê†ºÂºè‰∏çÊ≠£Á°Æ",icon:"none"})},isValidEmail:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),isValidPhone:e=>/^1[3-9]\d{9}$/.test(e),goBack(){uni.navigateBack()}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"avatar-section card"},[e.createElementVNode("view",{class:"section-title"},"Â§¥ÂÉè"),e.createElementVNode("view",{class:"avatar-wrapper",onClick:a[0]||(a[0]=(...e)=>l.chooseAvatar&&l.chooseAvatar(...e))},[n.formData.avatar&&(n.formData.avatar.startsWith("http")||n.formData.avatar.startsWith("blob:")||n.formData.avatar.startsWith("/")||n.formData.avatar.startsWith("data:"))?(e.openBlock(),e.createElementBlock("image",{key:0,src:n.formData.avatar,class:"avatar-image",mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"avatar-placeholder"},[e.createElementVNode("text",{class:"placeholder-icon"},"üì∑")])),e.createElementVNode("view",{class:"avatar-mask"},[e.createElementVNode("text",{class:"camera-icon"},"üì∑"),e.createElementVNode("text",{class:"change-text"},"Êõ¥Êç¢Â§¥ÂÉè")])])]),e.createElementVNode("view",{class:"form-section card"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},"Áî®Êà∑Âêç"),e.createElementVNode("view",{class:"form-value disabled"},e.toDisplayString(n.userInfo.username),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},"ÊòµÁß∞"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[1]||(a[1]=e=>n.formData.nickname=e),placeholder:"ËØ∑ËæìÂÖ•ÊòµÁß∞",maxlength:"20"},null,512),[[e.vModelText,n.formData.nickname]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},"ÈÇÆÁÆ±"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[2]||(a[2]=e=>n.formData.email=e),placeholder:"ËØ∑ËæìÂÖ•ÈÇÆÁÆ±",type:"text"},null,512),[[e.vModelText,n.formData.email]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label"},"ÊâãÊú∫Âè∑"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[3]||(a[3]=e=>n.formData.phone=e),placeholder:"ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑",type:"number",maxlength:"11"},null,512),[[e.vModelText,n.formData.phone]])])]),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{class:"btn-cancel",onClick:a[4]||(a[4]=(...e)=>l.goBack&&l.goBack(...e))},"ÂèñÊ∂à"),e.createElementVNode("button",{class:"btn-save",onClick:a[5]||(a[5]=(...e)=>l.saveProfile&&l.saveProfile(...e))},"‰øùÂ≠ò")])])}],["__scopeId","data-v-3938f21b"]]);const b=d({data:()=>({reminderEnabled:!1,reminderTime:"21:00",showTimePicker:!1,timePickerValue:[21,0],reminderTypes:{notification:!0,vibrate:!1,sound:!0},weekDays:[{label:"‰∏Ä",selected:!0},{label:"‰∫å",selected:!0},{label:"‰∏â",selected:!0},{label:"Âõõ",selected:!0},{label:"‰∫î",selected:!0},{label:"ÂÖ≠",selected:!0},{label:"Êó•",selected:!0}],reminderMessages:["üìù ËØ•ÂÜôÊó•ËÆ∞Âï¶ÔºåËÆ∞ÂΩï‰ªäÂ§©ÁöÑÁæéÂ•ΩÊó∂ÂÖâÔΩû","‚ú® ‰ªäÂ§©ÂèëÁîü‰∫Ü‰ªÄ‰πàÊúâË∂£ÁöÑ‰∫ãÂë¢Ôºü","üí≠ Èùô‰∏ãÂøÉÊù•ÔºåÂÜô‰∏ã‰ªäÂ§©ÁöÑÊÑüÂèóÂêß","üåü ÂùöÊåÅËÆ∞ÂΩïÔºåËÆ©ÁîüÊ¥ªÊõ¥ÊúâÊÑè‰πâ","üìñ ÂèàÊòØÂÖÖÂÆûÁöÑ‰∏ÄÂ§©ÔºåÊù•ÊÄªÁªì‰∏Ä‰∏ãÂêß"],selectedMessage:0}),onLoad(){this.loadSettings()},methods:{loadSettings(){try{const e=uni.getStorageSync("reminderSettings");if(e){const t=JSON.parse(e);this.reminderEnabled=t.enabled||!1,this.reminderTime=t.time||"21:00",this.reminderTypes=t.types||this.reminderTypes,this.weekDays=t.weekDays||this.weekDays,this.selectedMessage=t.messageIndex||0;const[a,s]=this.reminderTime.split(":");this.timePickerValue=[parseInt(a),parseInt(s)]}}catch(e){t("error","at pages/reminder/reminder.vue:195","Âä†ËΩΩÊèêÈÜíËÆæÁΩÆÂ§±Ë¥•:",e)}},saveSettings(){try{const e={enabled:this.reminderEnabled,time:this.reminderTime,types:this.reminderTypes,weekDays:this.weekDays,messageIndex:this.selectedMessage,message:this.reminderMessages[this.selectedMessage]};uni.setStorageSync("reminderSettings",JSON.stringify(e)),this.reminderEnabled?this.scheduleNotification():this.cancelNotification(),uni.showToast({title:"‰øùÂ≠òÊàêÂäü",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)}catch(e){t("error","at pages/reminder/reminder.vue:229","‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:",e),uni.showToast({title:"‰øùÂ≠òÂ§±Ë¥•",icon:"none"})}},onReminderToggle(e){this.reminderEnabled=e.detail.value},onTimeChange(e){this.timePickerValue=e.detail.value},confirmTime(){const[e,t]=this.timePickerValue;this.reminderTime=`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`,this.showTimePicker=!1},toggleType(e){this.reminderTypes[e]=!this.reminderTypes[e]},toggleWeekDay(e){this.weekDays[e].selected=!this.weekDays[e].selected},selectMessage(e){this.selectedMessage=e},scheduleNotification(){0!==this.weekDays.map(((e,t)=>e.selected?t+1:null)).filter((e=>null!==e)).length?uni.showToast({title:"ÊèêÈÜíÂ∑≤ËÆæÁΩÆ",icon:"success"}):uni.showToast({title:"ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏ÄÂ§©",icon:"none"})},cancelNotification(){uni.showToast({title:"ÊèêÈÜíÂ∑≤ÂèñÊ∂à",icon:"success"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"section card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("view",{class:"header-left"},[e.createElementVNode("text",{class:"section-icon"},"‚è∞"),e.createElementVNode("text",{class:"section-title"},"ÊØèÊó•ÊèêÈÜí")]),e.createElementVNode("switch",{checked:n.reminderEnabled,onChange:a[0]||(a[0]=(...e)=>l.onReminderToggle&&l.onReminderToggle(...e)),color:"#6366F1"},null,40,["checked"])]),e.createElementVNode("text",{class:"section-desc"},"ÂºÄÂêØÂêéÔºåÊØèÂ§©‰ºöÂú®ËÆæÂÆöÁöÑÊó∂Èó¥ÊèêÈÜíÊÇ®ÂÜôÊó•ËÆ∞")]),n.reminderEnabled?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section card"},[e.createElementVNode("view",{class:"time-setting",onClick:a[1]||(a[1]=e=>n.showTimePicker=!0)},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-icon"},"üïê"),e.createElementVNode("text",{class:"setting-label"},"ÊèêÈÜíÊó∂Èó¥")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("text",{class:"time-value"},e.toDisplayString(n.reminderTime),1),e.createElementVNode("text",{class:"arrow"},"‚Ä∫")])])])):e.createCommentVNode("",!0),n.reminderEnabled?(e.openBlock(),e.createElementBlock("view",{key:1,class:"section card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title-small"},"ÊèêÈÜíÊñπÂºè")]),e.createElementVNode("view",{class:"reminder-types"},[e.createElementVNode("view",{class:e.normalizeClass(["type-item",{active:n.reminderTypes.notification}]),onClick:a[2]||(a[2]=e=>l.toggleType("notification"))},[e.createElementVNode("text",{class:"type-icon"},"üîî"),e.createElementVNode("text",{class:"type-text"},"Á≥ªÁªüÈÄöÁü•"),n.reminderTypes.notification?(e.openBlock(),e.createElementBlock("view",{key:0,class:"check-icon"},"‚úì")):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["type-item",{active:n.reminderTypes.vibrate}]),onClick:a[3]||(a[3]=e=>l.toggleType("vibrate"))},[e.createElementVNode("text",{class:"type-icon"},"üì≥"),e.createElementVNode("text",{class:"type-text"},"ÈúáÂä®"),n.reminderTypes.vibrate?(e.openBlock(),e.createElementBlock("view",{key:0,class:"check-icon"},"‚úì")):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["type-item",{active:n.reminderTypes.sound}]),onClick:a[4]||(a[4]=e=>l.toggleType("sound"))},[e.createElementVNode("text",{class:"type-icon"},"üîä"),e.createElementVNode("text",{class:"type-text"},"ÊèêÁ§∫Èü≥"),n.reminderTypes.sound?(e.openBlock(),e.createElementBlock("view",{key:0,class:"check-icon"},"‚úì")):e.createCommentVNode("",!0)],2)])])):e.createCommentVNode("",!0),n.reminderEnabled?(e.openBlock(),e.createElementBlock("view",{key:2,class:"section card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title-small"},"ÈáçÂ§ç")]),e.createElementVNode("view",{class:"week-selector"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.weekDays,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["week-item",{active:t.selected}]),onClick:e=>l.toggleWeekDay(a)},[e.createElementVNode("text",{class:"week-text"},e.toDisplayString(t.label),1)],10,["onClick"])))),128))])])):e.createCommentVNode("",!0),n.reminderEnabled?(e.openBlock(),e.createElementBlock("view",{key:3,class:"section card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title-small"},"ÊèêÈÜíÊñáÊ°à")]),e.createElementVNode("view",{class:"message-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.reminderMessages,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["message-item",{active:n.selectedMessage===a}]),onClick:e=>l.selectMessage(a)},[e.createElementVNode("view",{class:"radio-icon"},[n.selectedMessage===a?(e.openBlock(),e.createElementBlock("view",{key:0,class:"radio-dot"})):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"message-text"},e.toDisplayString(t),1)],10,["onClick"])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"button-section"},[e.createElementVNode("button",{class:"btn-save",onClick:a[5]||(a[5]=(...e)=>l.saveSettings&&l.saveSettings(...e))},"‰øùÂ≠òËÆæÁΩÆ")]),n.showTimePicker?(e.openBlock(),e.createElementBlock("view",{key:4,class:"picker-overlay",onClick:a[10]||(a[10]=e=>n.showTimePicker=!1)},[e.createElementVNode("view",{class:"picker-container",onClick:a[9]||(a[9]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"picker-header"},[e.createElementVNode("text",{class:"picker-cancel",onClick:a[6]||(a[6]=e=>n.showTimePicker=!1)},"ÂèñÊ∂à"),e.createElementVNode("text",{class:"picker-title"},"ÈÄâÊã©Êó∂Èó¥"),e.createElementVNode("text",{class:"picker-confirm",onClick:a[7]||(a[7]=(...e)=>l.confirmTime&&l.confirmTime(...e))},"Á°ÆÂÆö")]),e.createElementVNode("picker-view",{value:n.timePickerValue,onChange:a[8]||(a[8]=(...e)=>l.onTimeChange&&l.onTimeChange(...e)),class:"time-picker"},[e.createElementVNode("picker-view-column",null,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(24,(t=>e.createElementVNode("view",{key:t,class:"picker-item"},e.toDisplayString(String(t-1).padStart(2,"0")),1))),64))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(60,(t=>e.createElementVNode("view",{key:t,class:"picker-item"},e.toDisplayString(String(t-1).padStart(2,"0")),1))),64))])],40,["value"])])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-833f0865"]]);const D=d({data:()=>({totalDiaries:0,dataSize:"0KB",backupLoading:!1,restoreLoading:!1,backupHistory:[],autoBackup:!1,backupFrequency:"ÊØèÂë®‰∏ÄÊ¨°",frequencyIndex:1,frequencyOptions:["ÊØèÂ§©","ÊØèÂë®‰∏ÄÊ¨°","ÊØè‰∏§Âë®","ÊØèÊúà‰∏ÄÊ¨°"],maxBackups:5,maxBackupIndex:1,maxBackupOptions:["3","5","10","20","‰∏çÈôêÂà∂"]}),onLoad(){this.loadBackupSettings(),this.loadBackupHistory(),this.loadDiaryStats()},methods:{async loadDiaryStats(){try{const e=await p({showLoading:!1,showError:!1});this.totalDiaries=e.length||0;const t=JSON.stringify(e||[]),a=Math.ceil(t.length/1024);this.dataSize=a<1024?a+"KB":(a/1024).toFixed(2)+"MB"}catch(e){t("error","at pages/backup/backup.vue:200","Âä†ËΩΩÁªüËÆ°Â§±Ë¥•:",e)}},async backupData(){if(!this.backupLoading)try{this.backupLoading=!0;const e=await p({showLoading:!0,showError:!0});if(!e||0===e.length)return void uni.showToast({title:"ÊöÇÊó†Êó•ËÆ∞Êï∞ÊçÆ",icon:"none"});const a={version:"1.0.0",exportTime:(new Date).toISOString(),diaryCount:e.length,diaries:e},s=JSON.stringify(a,null,2),o=`diary_backup_${this.formatDate(new Date)}.json`;plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS,(a=>{a.root.getFile(o,{create:!0},(a=>{a.createWriter((n=>{n.write(s),n.onwrite=()=>{this.saveToHistory({name:o,path:a.fullPath,time:this.formatDateTime(new Date),count:e.length,size:this.dataSize}),uni.showToast({title:"Â§á‰ªΩÊàêÂäü",icon:"success"}),uni.showModal({title:"Â§á‰ªΩÊàêÂäü",content:"Â§á‰ªΩÊñá‰ª∂Â∑≤‰øùÂ≠òÔºåÊòØÂê¶Ë¶ÅÂàÜ‰∫´Êàñ‰øùÂ≠òÂà∞ÂÖ∂‰ªñ‰ΩçÁΩÆÔºü",success:e=>{e.confirm&&plus.share.sendWithSystem({type:"file",path:a.fullPath},(()=>{t("log","at pages/backup/backup.vue:275","ÂàÜ‰∫´ÊàêÂäü")}),(e=>{t("log","at pages/backup/backup.vue:277","ÂàÜ‰∫´Â§±Ë¥•ÊàñÂèñÊ∂à",e),plus.runtime.openFile(a.fullPath,{},(e=>{uni.showToast({title:"Êñá‰ª∂Â∑≤‰øùÂ≠òÂà∞Â∫îÁî®ÁõÆÂΩï",icon:"none",duration:2e3})}))}))}})}}),(e=>{t("error","at pages/backup/backup.vue:292","ÂÜôÂÖ•Â§±Ë¥•:",e),uni.showToast({title:"Â§á‰ªΩÂ§±Ë¥•",icon:"none"})}))}))}))}catch(e){t("error","at pages/backup/backup.vue:351","Â§á‰ªΩÂ§±Ë¥•:",e),uni.showToast({title:"Â§á‰ªΩÂ§±Ë¥•",icon:"none"})}finally{this.backupLoading=!1}},restoreData(){uni.showModal({title:"Á°ÆËÆ§ÊÅ¢Â§ç",content:"ÊÅ¢Â§çÊï∞ÊçÆÂ∞ÜË¶ÜÁõñÁé∞ÊúâÊï∞ÊçÆÔºåÊòØÂê¶ÁªßÁª≠Ôºü",success:e=>{e.confirm&&plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS,(e=>{e.root.getDirectory("",{create:!0},(e=>{uni.showToast({title:"ËØ∑‰ªéÂ§á‰ªΩÂéÜÂè≤‰∏≠ÈÄâÊã©",icon:"none",duration:2e3})}))}))}})},readBackupFileFromPath(e){plus.io.resolveLocalFileSystemURL(e,(e=>{e.file((e=>{const a=new plus.io.FileReader;a.onloadend=e=>{try{const t=JSON.parse(e.target.result);this.processRestore(t)}catch(a){t("error","at pages/backup/backup.vue:472","Ëß£ÊûêÂ§á‰ªΩÊñá‰ª∂Â§±Ë¥•:",a),uni.showToast({title:"Êñá‰ª∂Ê†ºÂºèÈîôËØØ",icon:"none"})}},a.readAsText(e)}))}),(e=>{t("error","at pages/backup/backup.vue:482","ËØªÂèñÊñá‰ª∂Â§±Ë¥•:",e),uni.showToast({title:"ËØªÂèñÊñá‰ª∂Â§±Ë¥•",icon:"none"})}))},async processRestore(e){if(e.diaries&&Array.isArray(e.diaries)){uni.showLoading({title:"Ê≠£Âú®ÊÅ¢Â§ç...",mask:!0});try{await new Promise((e=>setTimeout(e,2e3))),uni.hideLoading(),uni.showToast({title:`ÊàêÂäüÊÅ¢Â§ç${e.diaries.length}ÁØáÊó•ËÆ∞`,icon:"success",duration:3e3}),setTimeout((()=>{this.loadDiaryStats()}),500)}catch(a){uni.hideLoading(),t("error","at pages/backup/backup.vue:555","ÊÅ¢Â§çÂ§±Ë¥•:",a),uni.showToast({title:"ÊÅ¢Â§çÂ§±Ë¥•",icon:"none"})}}else uni.showToast({title:"Â§á‰ªΩÊñá‰ª∂Ê†ºÂºèÈîôËØØ",icon:"none"})},restoreFromHistory(e){e.path?uni.showModal({title:"Á°ÆËÆ§ÊÅ¢Â§ç",content:`ÊòØÂê¶‰ªé"${e.name}"ÊÅ¢Â§çÊï∞ÊçÆÔºü\n\nÂåÖÂê´${e.count}ÁØáÊó•ËÆ∞`,success:a=>{a.confirm&&plus.io.resolveLocalFileSystemURL(e.path,(t=>{this.readBackupFileFromPath(e.path)}),(e=>{t("error","at pages/backup/backup.vue:591","Êñá‰ª∂‰∏çÂ≠òÂú®:",e),uni.showToast({title:"Â§á‰ªΩÊñá‰ª∂Â∑≤‰∏¢Â§±",icon:"none"})}))}}):uni.showToast({title:"Â§á‰ªΩÊñá‰ª∂Â∑≤‰∏¢Â§±",icon:"none"})},deleteBackup(e){const a=this.backupHistory[e];uni.showModal({title:"Á°ÆËÆ§Âà†Èô§",content:`Á°ÆÂÆöË¶ÅÂà†Èô§Â§á‰ªΩ"${a.name}"ÂêóÔºü\n\nÂåÖÂê´${a.count}ÁØáÊó•ËÆ∞`,success:s=>{s.confirm&&(a.path&&plus.io.resolveLocalFileSystemURL(a.path,(e=>{e.remove((()=>{t("log","at pages/backup/backup.vue:621","Êñá‰ª∂Âà†Èô§ÊàêÂäü")}),(e=>{t("error","at pages/backup/backup.vue:623","Êñá‰ª∂Âà†Èô§Â§±Ë¥•:",e)}))}),(e=>{t("log","at pages/backup/backup.vue:626","Êñá‰ª∂‰∏çÂ≠òÂú®ÊàñÂ∑≤Âà†Èô§:",e)})),this.backupHistory.splice(e,1),this.saveBackupHistory(),uni.showToast({title:"Â∑≤Âà†Èô§",icon:"success"}))}})},saveToHistory(e){this.backupHistory.unshift(e),this.backupHistory.length>20&&(this.backupHistory=this.backupHistory.slice(0,20)),this.saveBackupHistory()},loadBackupHistory(){const e=uni.getStorageSync("backupHistory");e&&(this.backupHistory=e)},saveBackupHistory(){uni.setStorageSync("backupHistory",this.backupHistory)},loadBackupSettings(){const e=uni.getStorageSync("backupSettings");e&&(this.autoBackup=e.autoBackup||!1,this.frequencyIndex=e.frequencyIndex||1,this.backupFrequency=this.frequencyOptions[this.frequencyIndex],this.maxBackupIndex=e.maxBackupIndex||1,this.maxBackups=parseInt(this.maxBackupOptions[this.maxBackupIndex])||5)},saveBackupSettings(){uni.setStorageSync("backupSettings",{autoBackup:this.autoBackup,frequencyIndex:this.frequencyIndex,maxBackupIndex:this.maxBackupIndex})},toggleAutoBackup(e){this.autoBackup=e.detail.value,this.saveBackupSettings(),this.autoBackup&&uni.showToast({title:"Â∑≤ÂºÄÂêØËá™Âä®Â§á‰ªΩ",icon:"success"})},changeFrequency(e){this.frequencyIndex=e.detail.value,this.backupFrequency=this.frequencyOptions[this.frequencyIndex],this.saveBackupSettings()},changeMaxBackups(e){this.maxBackupIndex=e.detail.value;const t=this.maxBackupOptions[this.maxBackupIndex];this.maxBackups="‰∏çÈôêÂà∂"===t?"‰∏çÈôêÂà∂":parseInt(t),this.saveBackupSettings()},formatDate:e=>`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}_${String(e.getHours()).padStart(2,"0")}${String(e.getMinutes()).padStart(2,"0")}`,formatDateTime:e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-icon"},"‚òÅÔ∏è"),e.createElementVNode("text",{class:"section-title"},"Â§á‰ªΩÊï∞ÊçÆ")]),e.createElementVNode("view",{class:"section-desc"},"Â∞ÜÊÇ®ÁöÑÊâÄÊúâÊó•ËÆ∞Êï∞ÊçÆÂ§á‰ªΩÂà∞Êú¨Âú∞Êñá‰ª∂"),e.createElementVNode("view",{class:"backup-info"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"Êó•ËÆ∞ÊÄªÊï∞"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(n.totalDiaries)+"ÁØá",1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"Êï∞ÊçÆÂ§ßÂ∞è"),e.createElementVNode("text",{class:"info-value"},"Á∫¶"+e.toDisplayString(n.dataSize),1)])]),e.createElementVNode("button",{class:"action-btn primary",onClick:a[0]||(a[0]=(...e)=>l.backupData&&l.backupData(...e)),loading:n.backupLoading},[e.createElementVNode("text",{class:"btn-icon"},"üì§"),e.createElementVNode("text",null,"Á´ãÂç≥Â§á‰ªΩ")],8,["loading"])]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-icon"},"üì•"),e.createElementVNode("text",{class:"section-title"},"ÊÅ¢Â§çÊï∞ÊçÆ")]),e.createElementVNode("view",{class:"section-desc"},"‰ªéÂ§á‰ªΩÊñá‰ª∂‰∏≠ÊÅ¢Â§çÊÇ®ÁöÑÊó•ËÆ∞Êï∞ÊçÆ"),e.createElementVNode("view",{class:"warning-box"},[e.createElementVNode("text",{class:"warning-icon"},"‚ö†Ô∏è"),e.createElementVNode("text",{class:"warning-text"},"ÊÅ¢Â§çÊï∞ÊçÆÂ∞ÜË¶ÜÁõñÁé∞ÊúâÊï∞ÊçÆÔºåËØ∑Ë∞®ÊÖéÊìç‰Ωú")]),e.createElementVNode("button",{class:"action-btn secondary",onClick:a[1]||(a[1]=(...e)=>l.restoreData&&l.restoreData(...e)),loading:n.restoreLoading},[e.createElementVNode("text",{class:"btn-icon"},"üìÇ"),e.createElementVNode("text",null,"ÈÄâÊã©Â§á‰ªΩÊñá‰ª∂")],8,["loading"])]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-icon"},"üìã"),e.createElementVNode("text",{class:"section-title"},"Â§á‰ªΩÂéÜÂè≤")]),0===n.backupHistory.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"üì≠"),e.createElementVNode("text",{class:"empty-text"},"ÊöÇÊó†Â§á‰ªΩËÆ∞ÂΩï")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"history-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.backupHistory,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"history-item"},[e.createElementVNode("view",{class:"history-info"},[e.createElementVNode("view",{class:"history-top"},[e.createElementVNode("text",{class:"history-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"history-size"},e.toDisplayString(t.size),1)]),e.createElementVNode("text",{class:"history-time"},e.toDisplayString(t.time),1),e.createElementVNode("text",{class:"history-count"},"ÂåÖÂê´"+e.toDisplayString(t.count)+"ÁØáÊó•ËÆ∞",1)]),e.createElementVNode("view",{class:"history-actions"},[e.createElementVNode("button",{class:"action-icon-btn",onClick:e=>l.restoreFromHistory(t)},[e.createElementVNode("text",null,"üì•")],8,["onClick"]),e.createElementVNode("button",{class:"action-icon-btn delete",onClick:e=>l.deleteBackup(a)},[e.createElementVNode("text",null,"üóëÔ∏è")],8,["onClick"])])])))),128))]))]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-icon"},"‚öôÔ∏è"),e.createElementVNode("text",{class:"section-title"},"Ëá™Âä®Â§á‰ªΩËÆæÁΩÆ")]),e.createElementVNode("view",{class:"settings-list"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"ÂêØÁî®Ëá™Âä®Â§á‰ªΩ"),e.createElementVNode("text",{class:"setting-desc"},"ÊØèÂë®Ëá™Âä®Â§á‰ªΩ‰∏ÄÊ¨°")]),e.createElementVNode("switch",{checked:n.autoBackup,onChange:a[2]||(a[2]=(...e)=>l.toggleAutoBackup&&l.toggleAutoBackup(...e)),color:"#6366F1"},null,40,["checked"])]),n.autoBackup?(e.openBlock(),e.createElementBlock("view",{key:0,class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"Â§á‰ªΩÈ¢ëÁéá"),e.createElementVNode("text",{class:"setting-desc"},e.toDisplayString(n.backupFrequency),1)]),e.createElementVNode("picker",{mode:"selector",range:n.frequencyOptions,value:n.frequencyIndex,onChange:a[3]||(a[3]=(...e)=>l.changeFrequency&&l.changeFrequency(...e))},[e.createElementVNode("text",{class:"setting-value"},e.toDisplayString(n.backupFrequency)+" ‚Ä∫",1)],40,["range","value"])])):e.createCommentVNode("",!0),n.autoBackup?(e.openBlock(),e.createElementBlock("view",{key:1,class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"‰øùÁïôÂ§á‰ªΩÊï∞"),e.createElementVNode("text",{class:"setting-desc"},"ÊúÄÂ§ö‰øùÁïô"+e.toDisplayString(n.maxBackups)+"‰∏™Â§á‰ªΩ",1)]),e.createElementVNode("picker",{mode:"selector",range:n.maxBackupOptions,value:n.maxBackupIndex,onChange:a[4]||(a[4]=(...e)=>l.changeMaxBackups&&l.changeMaxBackups(...e))},[e.createElementVNode("text",{class:"setting-value"},e.toDisplayString(n.maxBackups)+"‰∏™ ‚Ä∫",1)],40,["range","value"])])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"card tips-card"},[e.createElementVNode("view",{class:"tips-header"},[e.createElementVNode("text",{class:"tips-icon"},"üí°"),e.createElementVNode("text",{class:"tips-title"},"‰ΩøÁî®ËØ¥Êòé")]),e.createElementVNode("view",{class:"tips-list"},[e.createElementVNode("text",{class:"tip-item"},"‚Ä¢ Â§á‰ªΩÊñá‰ª∂ÂåÖÂê´ÊâÄÊúâÊó•ËÆ∞ÂÜÖÂÆπ„ÄÅÂõæÁâáÈìæÊé•ÂíåËßÜÈ¢ëÈìæÊé•"),e.createElementVNode("text",{class:"tip-item"},"‚Ä¢ Âª∫ËÆÆÂÆöÊúüÂ§á‰ªΩÔºåÈò≤Ê≠¢Êï∞ÊçÆ‰∏¢Â§±"),e.createElementVNode("text",{class:"tip-item"},"‚Ä¢ ÊÅ¢Â§çÊï∞ÊçÆÊó∂ËØ∑Á°Æ‰øùÂ§á‰ªΩÊñá‰ª∂ÂÆåÊï¥ÊúâÊïà"),e.createElementVNode("text",{class:"tip-item"},"‚Ä¢ ÂõæÁâáÂíåËßÜÈ¢ëÊñá‰ª∂‰∏ç‰ºöË¢´ÊâìÂåÖÔºå‰ªÖ‰øùÂ≠òÈìæÊé•"),e.createElementVNode("text",{class:"tip-item"},"‚Ä¢ Â§á‰ªΩÊñá‰ª∂Ê†ºÂºè‰∏∫JSONÔºåÂèØÁî®ÊñáÊú¨ÁºñËæëÂô®Êü•Áúã")])])])}],["__scopeId","data-v-cb149b39"]]);const S=d({data:()=>({keyword:"",searchResults:[],searched:!1}),methods:{async handleSearch(){var e;if(this.keyword.trim())try{const t=await(e=this.keyword.trim(),l("/diary/search/keyword",{keyword:e}));this.searchResults=t,this.searched=!0}catch(a){t("error","at pages/search/search.vue:103","ÊêúÁ¥¢Â§±Ë¥•:",a),this.searchResults=[],this.searched=!0}else uni.showToast({title:"ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç",icon:"none"})},viewDiary(e){uni.navigateTo({url:`/pages/detail/detail?date=${e.diary_date}`})},highlightKeyword(e){if(!this.keyword.trim()||!e)return e;const t=new RegExp(`(${this.keyword})`,"gi");return e.replace(t,'<span style="color: #6366F1; font-weight: bold; background: #EEF2FF; padding: 2rpx 4rpx; border-radius: 4rpx;">$1</span>')},formatDateText(e){const t=new Date(e);return`${t.getFullYear()}Âπ¥${t.getMonth()+1}Êúà${t.getDate()}Êó•`},getWeekDay:e=>["Âë®Êó•","Âë®‰∏Ä","Âë®‰∫å","Âë®‰∏â","Âë®Âõõ","Âë®‰∫î","Âë®ÂÖ≠"][new Date(e).getDay()],getCompressedUrl:e=>e?e.includes("aliyuncs.com")?e+"?x-oss-process=image/resize,w_200/quality,q_80/format,webp":e:""}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"search-section card"},[e.createElementVNode("view",{class:"search-box"},[e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.keyword=e),placeholder:"ÊêúÁ¥¢Êó•ËÆ∞ÂÜÖÂÆπ...","confirm-type":"search",onConfirm:a[1]||(a[1]=(...e)=>l.handleSearch&&l.handleSearch(...e))},null,544),[[e.vModelText,n.keyword]]),e.createElementVNode("button",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>l.handleSearch&&l.handleSearch(...e))},[e.createElementVNode("text",{class:"search-icon"},"üîç")])]),e.createElementVNode("view",{class:"search-tip"},[e.createElementVNode("text",{class:"tip-text"},"ËæìÂÖ•ÂÖ≥ÈîÆËØçÊêúÁ¥¢Êó•ËÆ∞ÂÜÖÂÆπ")])]),e.createElementVNode("view",{class:"result-section"},[n.searched?0===n.searchResults.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"üì≠"),e.createElementVNode("text",{class:"empty-text"},"Êú™ÊâæÂà∞Áõ∏ÂÖ≥Êó•ËÆ∞"),e.createElementVNode("text",{class:"empty-tip"},"Êç¢‰∏™ÂÖ≥ÈîÆËØçËØïËØïÔΩû")])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"diary-list"},[e.createElementVNode("view",{class:"result-count"},[e.createElementVNode("text",{class:"count-text"},"ÊâæÂà∞ "+e.toDisplayString(n.searchResults.length)+" Êù°ÁªìÊûú",1)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.searchResults,(t=>(e.openBlock(),e.createElementBlock("view",{class:"diary-item card",key:t.id,onClick:e=>l.viewDiary(t)},[e.createElementVNode("view",{class:"diary-header"},[e.createElementVNode("view",{class:"date-info"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(l.formatDateText(t.diary_date)),1),e.createElementVNode("text",{class:"week-text"},e.toDisplayString(l.getWeekDay(t.diary_date)),1)]),e.createElementVNode("view",{class:"mood-weather"},[e.createElementVNode("text",{class:"mood-icon"},e.toDisplayString(t.mood),1),e.createElementVNode("text",{class:"weather-icon"},e.toDisplayString(t.weather),1)])]),e.createElementVNode("text",{class:"diary-content",innerHTML:l.highlightKeyword(t.content)},null,8,["innerHTML"]),t.images&&t.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"media-preview"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.images.slice(0,3),((t,a)=>(e.openBlock(),e.createElementBlock("image",{key:"img"+a,src:l.getCompressedUrl(t),class:"media-thumb",mode:"aspectFill"},null,8,["src"])))),128)),t.images.length>3?(e.openBlock(),e.createElementBlock("view",{key:0,class:"more-media"},[e.createElementVNode("text",null,"+"+e.toDisplayString(t.images.length-3),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],8,["onClick"])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"üîç"),e.createElementVNode("text",{class:"empty-text"},"ËæìÂÖ•ÂÖ≥ÈîÆËØçÂºÄÂßãÊêúÁ¥¢")]))])])}],["__scopeId","data-v-0db7c2a5"]]);const B=d({data:()=>({stats:{totalDays:0,totalWords:0,continuousDays:0,avgWordsPerDay:0},moodStats:[],weatherStats:[],monthStats:[],maxMonthCount:0,moodMap:{"üòä":"ÂºÄÂøÉ","üòÑ":"Âø´‰πê","üòå":"Âπ≥Èùô","üòî":"Â§±ËêΩ","üò¢":"ÈöæËøá","üò°":"ÁîüÊ∞î","üò¥":"Âõ∞ÂÄ¶","ü§î":"ÊÄùËÄÉ","üòç":"ÂÖ¥Â•ã","üò∞":"ÁÑ¶Ëôë","üò§":"ÁîüÊ∞î"},weatherMap:{"‚òÄÔ∏è":"Êô¥Â§©","‚õÖ":"Â§ö‰∫ë","‚òÅÔ∏è":"Èò¥Â§©","üåßÔ∏è":"Èõ®Â§©","‚õàÔ∏è":"Èõ∑Èõ®","üå®Ô∏è":"‰∏ãÈõ™","üå´Ô∏è":"ÈõæÈúæ","üå™Ô∏è":"Â§ßÈ£é"}}),onLoad(){this.loadData()},methods:{async loadData(){try{const e=await g();this.stats={...e,avgWordsPerDay:e.totalDays>0?Math.round(e.totalWords/e.totalDays):0};const t=await p({showLoading:!1});this.calculateMoodStats(t),this.calculateWeatherStats(t),this.calculateMonthStats(t)}catch(e){t("error","at pages/stats/stats.vue:168","Âä†ËΩΩÁªüËÆ°Êï∞ÊçÆÂ§±Ë¥•:",e)}},calculateMoodStats(e){const t={};let a=0;e.forEach((e=>{const s=e.mood||"üòä";t[s]=(t[s]||0)+1,a++})),this.moodStats=Object.entries(t).map((([e,t])=>({mood:e,count:t,percentage:Math.round(t/a*100)}))).sort(((e,t)=>t.count-e.count))},calculateWeatherStats(e){const t={};e.forEach((e=>{const a=e.weather||"‚òÄÔ∏è";t[a]=(t[a]||0)+1})),this.weatherStats=Object.entries(t).map((([e,t])=>({weather:e,count:t}))).sort(((e,t)=>t.count-e.count))},calculateMonthStats(e){const t={};e.forEach((e=>{const a=new Date(e.diary_date).getMonth()+1;t[a]=(t[a]||0)+1})),this.monthStats=Object.entries(t).map((([e,t])=>({month:parseInt(e),count:t}))).sort(((e,t)=>e.month-t.month)),this.maxMonthCount=Math.max(...this.monthStats.map((e=>e.count)),1)},getMoodName(e){return this.moodMap[e]||"Êú™Áü•"},getWeatherName(e){return this.weatherMap[e]||"Êú™Áü•"},formatWords:e=>e>=1e4?(e/1e4).toFixed(1)+"‰∏á":e}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page-container"},[e.createElementVNode("view",{class:"stats-overview card"},[e.createElementVNode("view",{class:"overview-title"},[e.createElementVNode("text",{class:"title-text"},"üìä Êï∞ÊçÆÊÄªËßà")]),e.createElementVNode("view",{class:"stats-grid"},[e.createElementVNode("view",{class:"stat-cell"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.totalDays),1),e.createElementVNode("text",{class:"stat-label"},"ËÆ∞ÂΩïÂ§©Êï∞")]),e.createElementVNode("view",{class:"stat-cell"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(l.formatWords(n.stats.totalWords)),1),e.createElementVNode("text",{class:"stat-label"},"ÊÄªÂ≠óÊï∞")]),e.createElementVNode("view",{class:"stat-cell"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.continuousDays),1),e.createElementVNode("text",{class:"stat-label"},"ËøûÁª≠Â§©Êï∞")]),e.createElementVNode("view",{class:"stat-cell"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.avgWordsPerDay),1),e.createElementVNode("text",{class:"stat-label"},"Êó•ÂùáÂ≠óÊï∞")])])]),e.createElementVNode("view",{class:"mood-stats card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-text"},"üòä ÂøÉÊÉÖÂàÜÂ∏É")]),0===n.moodStats.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},[e.createElementVNode("text",null,"ÊöÇÊó†ÂøÉÊÉÖÊï∞ÊçÆ")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"mood-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.moodStats,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"mood-item",key:a},[e.createElementVNode("view",{class:"mood-info"},[e.createElementVNode("text",{class:"mood-emoji"},e.toDisplayString(t.mood),1),e.createElementVNode("text",{class:"mood-name"},e.toDisplayString(l.getMoodName(t.mood)),1)]),e.createElementVNode("view",{class:"mood-progress"},[e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:t.percentage+"%"})},null,4)]),e.createElementVNode("text",{class:"mood-count"},e.toDisplayString(t.count)+"Ê¨° ("+e.toDisplayString(t.percentage)+"%)",1)])])))),128))]))]),e.createElementVNode("view",{class:"weather-stats card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-text"},"üå§Ô∏è Â§©Ê∞îÂàÜÂ∏É")]),0===n.weatherStats.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},[e.createElementVNode("text",null,"ÊöÇÊó†Â§©Ê∞îÊï∞ÊçÆ")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"weather-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.weatherStats,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"weather-item",key:a},[e.createElementVNode("text",{class:"weather-emoji"},e.toDisplayString(t.weather),1),e.createElementVNode("text",{class:"weather-name"},e.toDisplayString(l.getWeatherName(t.weather)),1),e.createElementVNode("text",{class:"weather-count"},e.toDisplayString(t.count)+"Ê¨°",1)])))),128))]))]),e.createElementVNode("view",{class:"month-stats card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-text"},"üìÖ ÊúàÂ∫¶ÁªüËÆ°")]),0===n.monthStats.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},[e.createElementVNode("text",null,"ÊöÇÊó†ÊúàÂ∫¶Êï∞ÊçÆ")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"month-chart"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.monthStats,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"month-bar",key:a},[e.createElementVNode("view",{class:"bar-container"},[e.createElementVNode("view",{class:"bar-fill",style:e.normalizeStyle({height:t.count/n.maxMonthCount*100+"%"})},null,4)]),e.createElementVNode("text",{class:"bar-label"},e.toDisplayString(t.month)+"Êúà",1),e.createElementVNode("text",{class:"bar-value"},e.toDisplayString(t.count),1)])))),128))]))])])}],["__scopeId","data-v-8f7cbaaf"]]);__definePage("pages/login/login",m),__definePage("pages/register/register",u),__definePage("pages/index/index",y),__definePage("pages/write/write",k),__definePage("pages/detail/detail",E),__definePage("pages/list/list",v),__definePage("pages/mine/mine",N),__definePage("pages/profile/profile",f),__definePage("pages/reminder/reminder",b),__definePage("pages/backup/backup",D),__definePage("pages/search/search",S),__definePage("pages/stats/stats",B);const C={onLaunch:function(){t("log","at App.vue:9","App Launch"),this.checkLoginStatus()},onShow:function(){t("log","at App.vue:13","App Show")},onHide:function(){t("log","at App.vue:16","App Hide")},methods:{checkLoginStatus(){(function(){const e=uni.getStorageSync("userToken"),t=uni.getStorageSync("userInfo");return!(!e||!t)})()||uni.reLaunch({url:"/pages/login/login"})}}};const{app:T,Vuex:M,Pinia:P}={app:e.createVueApp(C)};uni.Vuex=M,uni.Pinia=P,T.provide("__globalStyles",__uniConfig.styles),T._component.mpType="app",T._component.render=()=>{},T.mount("#app")}(Vue);
